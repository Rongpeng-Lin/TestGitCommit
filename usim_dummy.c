/*******************************************************************************
  @(#)Copyright(C)2008,DaLian HuaChang Electronics & Communication Co,. LTD.
  File name    : UiccDummy.c
  Description  : 
  History:
    1. wuhao    2019-07-12  Create
*******************************************************************************/


#include "usim/include/usim_inc.h"


typedef struct 
{
    UINT8  SelectInfoNum;
    UINT8 *SelectInfo[2];
    UINT8  DataInfoNum;
    UINT8 *DataInfo[4];
}DUMY_EF_INFO_STRU;

#ifdef DUMMY_USIM_TEST
UINT8              aucDumyUsimIk[16];
UINT8              aucDumyUsimCk[16];
UINT8              aucDumyUsimAk[6];
UINT8              aucDumyUsimKc[8];
UINT8              aucDumyUsimXmac[8];
UINT8              aucDumyUsimRes[16];
UINT8              aucDumyUsimAuts[14];

//Dumy_usim_exchange_apdu
UINT8              aucIk[16];
UINT8              aucCk[16];
UINT8              aucAk[6];
UINT8              aucKc[8];
UINT8              aucXmac[8];
UINT8              aucRes[16];
UINT8              aucAuts[14];

UINT8 ucSelectFlg = 0;
UINT8 ucAssertFlg = 0;
UINT8 ucTestCnt = 0;
UINT8 g_UiccDetectCnt = 0;
/*******************************************************************************
    Module:      Usim_MakeXdout
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_MakeXdout(UINT8 *pXdout, UINT8 *pK, UINT8 *pRand)
{
    UINT8             i;

    for(i = 0; i < 16; i++) 
    {
        pXdout[i] = pK[i] ^ pRand[i];
    }
    return 0;
}

/*******************************************************************************
    Module:      Usim_ArrangeString
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_ArrangeString(UINT8 *pOut, UINT8 *pIn, SINT32 InLength, SINT32 Position)
{
    SINT32 i;

    for(i = 0; i < InLength; i++) 
    {
        pOut[i] = pIn[(i + Position) % InLength];
    }
    return 0;
}

/*******************************************************************************
    Module:      Usim_CalcF1
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_CalcF1(UINT8 *pXmac, UINT8 *pXdout, UINT8 *pCdout)
{
    UINT8       i;

    for(i = 0; i < 8; i++) 
    {
        pXmac[i] = pXdout[i] ^ pCdout[i];
    }
    return 0;
}

/*******************************************************************************
    Module:      Usim_CalcF2
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_CalcF2(UINT8 *pRes, UINT8 *pXdout)
{
    OSAdpMemCpy(pRes, pXdout, 16, MEM_OPERATE_0_CHECK);
    return 0;
}

/*******************************************************************************
    Module:      Usim_CalcF3
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_CalcF3(UINT8 *pCk, UINT8 *pXdout)
{
    Usim_ArrangeString(pCk, pXdout, 16, 1);
    return 0;
}

/*******************************************************************************
    Module:      Usim_CalcF4
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_CalcF4(UINT8 *pIk, UINT8 *pXdout)
{
    Usim_ArrangeString(pIk, pXdout, 16, 2);
    return 0;
}

/*******************************************************************************
    Module:      Usim_CalcF5
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_CalcF5(UINT8 *pAk, UINT8 *pXdout)
{
    OSAdpMemCpy(pAk, pXdout + 3, 6, MEM_OPERATE_0_CHECK);
    return 0;
}

/*******************************************************************************
    Module:      Usim_MakeCdout
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.25     new
*******************************************************************************/
UINT8 Usim_MakeCdout(UINT8 *pCdout, UINT8 *pSqn, UINT8 *pAmf)
{
    UINT8    i, j;

    for(i = 0; i < 6; i++)
    {
        pCdout[i] = pSqn[i];
    }

    for(j = 0; i < 8; i++, j++)
    {
        pCdout[i] = pAmf[j];
    }
    return 0;
}

/*******************************************************************************
    Module:      Usim_Authentication_Ret
    Function:    test usim(copy from LnbBuild)
    Input:       
    Output:      
    NOTE:        
    Return:       
    History:
      1. liuxin   2016.08.24     new
*******************************************************************************/
UINT8 Usim_Authentication_Ret(UINT8 *pRand, UINT8 *pAutn)
{
    UINT8                        i,j;
    UINT8                        aucK[16];
    UINT8                        aucXdout[16];
    UINT8                        aucCdout[16];
    UINT8                        aucAmf[2];
    UINT8                        aucSqn[6];
    UINT8                        aucMac[8];

    for(i=0; i<16; i++)
    {
        aucK[i] = i;
    }
    Usim_MakeXdout(aucXdout,aucK,pRand);
    Usim_CalcF2(aucRes,aucXdout);
    Usim_CalcF3(aucCk,aucXdout);
    Usim_CalcF4(aucIk,aucXdout);
    Usim_CalcF5(aucAk,aucXdout);
    for(i=0; i<6; i++)
    {
        aucSqn[i] = pAutn[i] ^  aucAk[i];
    }
    aucAmf[0] = pAutn[6];
    aucAmf[1] = pAutn[7];

    /* YYN: non-EPS authentication unacceptable handling   start */
    if (0 == (aucAmf[0]&0x80))
    {
        return 3;
    }
    /* YYN: non-EPS authentication unacceptable handling   end */
    Usim_MakeCdout(aucCdout,aucSqn,aucAmf);
    Usim_CalcF1(aucXmac,aucXdout,aucCdout);
    for(i=0; i<8; i++)
    {
         aucMac[i] = pAutn[i+8];
    }

    if((0xff == aucAmf[0]) && (0xff == aucAmf[1]))
    {
        // calculate auts
        for(i=0; i<6; i++)
        {
            aucAuts[i] = aucSqn[i] ^  aucAk[i];
        } 
        for(j=6; j<14; j++)
        {
            aucAuts[j] = aucXmac[j-6];
        }     
        return 1;
    }
    for(i=0; i<8; i++)
    {
        if(aucXmac[i] != aucMac[i])
        {
            return 2;
        }
    }
    return 0;
}
 UINT32 ulEfidRec = 0;
 UINT8 ucSel3f00[4] = {2,0x90,0x00,0};
 UINT8 ucSel2f00[44] = {2,0x90,0x00,40,0x62,0x26,0x82,0x05,0x42,0x21,0x00,0x26,0x01,0x83,0x02,0x2f,0x00,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x2f,0x06,0x01,0x80,0x02,0x00,0x26,0x81,0x02,0x00,0x33,0x88,0x01,0xf0};
 UINT8 ucRead2f00[42] = {2,0x90,0x00,38,0x61,0x14,0x4f,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,0x50,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead2f00_Aid_Error[42] = {2,0x90,0x00,38,0x61,0x14,0x4f,0x10,0xa0,0x00,0x00,0x00,0x89,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,0x50,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSelDF[61] = {2,0x90,0x00,57,0x62,0x37,0x82,0x02,0x78,0x21,0x84,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,0xa5,0x0c,0x80,0x01,0x31,0x82,0x01,0xff,0x83,0x04,0x00,0x00,0x78,0x08,0x8a,0x01,0x05,0x8b,0x03,0x2f,0x06,0x07,0xc6,0x09,0x90,0x01,0x40,0x83,0x01,0x01,0x83,0x01,0x81};
 UINT8 ucSelDF_PIN_TEST[61] = {2,0x90,0x00,57,0x62,0x37,0x82,0x02,0x78,0x21,0x84,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,0xa5,0x0c,0x80,0x01,0x31,0x82,0x01,0xff,0x83,0x04,0x00,0x00,0x78,0x08,0x8a,0x01,0x05,0x8b,0x03,0x2f,0x06,0x07,0xc6,0x09,0x90,0x01,0x80,0x83,0x01,0x01,0x83,0x01,0x81};
 UINT8 ucSelDF_Fcp_Error[4] = {2,0x90,0x00,0};
 UINT8 ucSel2f08[4] = {2,0x90,0x00,0};
 UINT8 ucRead2f08[9] = {2,0x90,0x00,5,0x0A,0x09,0x02,0x00,0x00};
 UINT8 ucSel2fe2[4] = {2,0x90,0x00,0};
 UINT8 ucRead2fe2[14] = {2,0x90,0x00,10,0x08,0x09,0x10,0x07,0x06,0x05,0x04,0x03,0x02,0x01};
 UINT8 ucSel6f07[4] = {2,0x90,0x00,0};
#ifdef START_MODE_ST
 UINT8 ucRead6f07[13] = {2,0x90,0x00,9,0x08,0x09,0x10,0x10,0x10,0x32,0x54,0x06,0x36};
#else
 UINT8 ucRead6f07[13] = {2,0x90,0x00,9,0x08,0x09,0x10,0x10,0x48,0x11,0x83,0x21,0x83};
#endif

 UINT8 ucSel6f09[4] = {2,0x90,0x00,0};
 UINT8 ucRead6f09[37] = {2,0x90,0x00,33,0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x00,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x0a,0x0b,0x0c,0x0d,0x0e,0x0f,0x00,0x01};
 UINT8 ucSel6f31[40] = {2,0x90,0x00,36,0x62,0x22,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x45,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x01,0x81,0x02,0x00,0x35,0x88,0x00};
 UINT8 ucRead6f31[5] = {2,0x90,0x00,1,0x50};
 UINT8 ucSel6f38[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x38,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x11,0x81,0x02,0x00,0x1e,0x88,0x01,0x20};
 // 6f38 base
 UINT8 ucRead6f38[21] = {2,0x90,0x00,17,0x84,0x7d,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x00};
 UINT8 ucRead6f38_Noehplmn[21] = {2,0x90,0x00,17,0x84,0x7d,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x00,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x00};
 UINT8 ucRead6f38_NoPLMNwACT[21] = {2,0x90,0x00,17,0x84,0x7d,0x13,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x00}; // 6f38 base
 UINT8 ucRead6f38_ME_Calc_Suci[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x6e,0x00};
 UINT8 ucRead6f38_Sms[21] = {2,0x90,0x00,17,0x84,0x7f,0x1f,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x00};
 UINT8 ucSel6f56[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x56,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x01,0x81,0x02,0x00,0x0e,0x88,0x01,0x50};
 UINT8 ucRead6f56[5] = {2,0x90,0x00,1,0x00};
 UINT8 ucSel6f60_1[4] = {2,0x90,0x00,0};
 UINT8 ucSel6f60_2[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x60,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x28,0x81,0x02,0x00,0x35,0x88,0x01,0x50};
 UINT8 ucRead6f60[44] = {2,0x90,0x00,40,0x00,0xf1,0x10,0xf8,0x1c,0x00,0xf1,0x13,0xf8,0x1c,0x00,0xf1,0x12,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f60_Plmn_Search[44] = {2,0x90,0x00,40,0x00,0xf1,0x10,0xf8,0x1c,0x00,0xf1,0x12,0xf8,0x1c,0x00,0xf1,0x15,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSel6f61[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x61,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x3c,0x81,0x02,0x00,0x49,0x88,0x01,0x88};
 UINT8 ucRead6f61[64] = {2,0x90,0x00,60,0x00,0xf1,0x11,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f61_Plmn_Search[64] = {2,0x90,0x00,60,0x00,0xf1,0x15,0xf8,0x1c,0x00,0xf1,0x11,0xf8,0x1c,0x00,0xf1,0x16,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSel6f78[4] = {2,0x90,0x00,0};
 UINT8 ucRead6f78[6] = {2,0x90,0x00,2,0x00,0x40};
 UINT8 ucRead6f78_HighPori[6] = {2,0x90,0x00,2,0xf8,0x40};
 UINT8 ucSel6f7b[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x7b,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x0c,0x81,0x02,0x00,0x19,0x88,0x01,0x68};
 
#ifdef START_MODE_ST
 UINT8 ucRead6f7b[16] = {2,0x90,0x00,12,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
#else
UINT8 ucRead6f7b[16] = {2,0x90,0x00,12,0x00,0x13,0x01,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
#endif
 
 UINT8 ucSel6fad[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0xad,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x01,0x80,0x02,0x00,0x04,0x81,0x02,0x00,0x11,0x88,0x01,0x18};
 UINT8 ucRead6fad[8] = {2,0x90,0x00,4,0x00,0x00,0x00,0x02};
 UINT8 ucSel6fd9[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0xd9,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x0c,0x81,0x02,0x00,0x19,0x88,0x01,0xe8};
 UINT8 ucRead6fd9[16] = {2,0x90,0x00,12,0x00,0xf1,0x10,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6fd9_Plmn_Search[16] = {2,0x90,0x00,12,0x00,0xf1,0x10,0x00,0xf1,0x13,0x00,0xf1,0x14,0xff,0xff,0xff};
 UINT8 ucSel6fdb[40] = {0x02,0x90,0x00,0x24,0x62,0x22,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0xdb,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x01,0x81,0x02,0x00,0x0e,0x88,0x00};
 UINT8 ucRead6fdb[5] = {0x02,0x90,0x00,0x01,0x01};
 UINT8 ucRead6fdb_changeEHPLMNPI[5] = {0x02,0x90,0x00,0x01,0x02};
 UINT8 ucSel6fdc[40] = {0x02,0x90,0x00,0x24,0x62,0x22,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0xdc,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x01,0x81,0x02,0x00,0x0e,0x88,0x00};
 UINT8 ucRead6fdc[5] = {0x02,0x90,0x00,0x01,0x00};
 UINT8 ucRead6fdc_regist_on_last_plmn[5] = {0x02,0x90,0x00,0x01,0x01};
 UINT8 ucSel6fe8[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x38,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x2E,0x81,0x02,0x00,0x16,0x88,0x01,0x20};
 UINT8 ucRead6fe8[50] = {2,0x90,0x00,46,0x80,0x01,0x00,0x81,0x01,0x00,0x82,0x01,0x00,0x83,0x01,0x00,0x84,0x01,0x00,0x85,0x01,0x00,0x86,0x01,0x00,0x87,0x01,0x00,0x88,0x01,0x01,0x89,0x01,0x00,0x8A,0x01,0xAC,0x8B,0x01,0x00,0x8C,0x02,0x00,0x00,0x8D,0x01,0x01,0x8E,0x01,0x00};
 UINT8 ucSel6fec[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0xec,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x01,0x81,0x02,0x00,0x0e,0x88,0x01,0x50};
 UINT8 ucRead6fec[5] ={2,0x90,0x00,1,0x00};
 UINT8 ucSel4f01[4] = {2,0x90,0x00,0};
 UINT8 ucRead4f01[24] = {2,0x90,0x00,20,0x00,0x0b,0xf6,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x01};
 UINT8 ucRead4F01_Rplmn[24] = {2,0x90,0x00,20,0x00,0x0b,0xf6,0x00,0xf1,0x10,0xfe,0x01,0x41,0x28,0x52,0xd2,0xa4,0x00,0xf1,0x10,0x00,0x00,0x01,0x00};
 UINT8 ucSel4f03[44] = {2,0x90,0x00,40,0x62,0x26,0x82,0x05,0x42,0x21,0x00,0x39,0x01,0x83,0x02,0x4f,0x03,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x39,0x81,0x02,0x00,0x46,0x88,0x01,0x03};
 UINT8 ucRead4f03[61] = {2,0x90,0x00,57,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead4f03_Rplmn[61] = {2,0x90,0x00,57,0xa0,0x34,0x80,0x01,0x01,0x81,0x20,0x0e,0x9f,0x7d,0x5d,0xc9,0xf6,0xe5,0xad,0xc4,0x79,0x4b,0x30,0xeb,0x69,0xbd,0x20,0xc4,0x0a,0x1c,0x4d,0xc9,0xe0,0x55,0x00,0x38,0x4f,0x06,0x96,0x15,0xfd,0x7a,0xda,0x82,0x04,0x00,0x00,0x00,0x03,0x83,0x04,0x00,0x00,0x00,0x00,0x84,0x01,0x11,0x00,0x00,0x00};
 UINT8 ucSel4f05[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x4f,0x05,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x44,0x81,0x02,0x00,0x51,0x88,0x01,0x05};
 UINT8 ucRead4f05[72] = {2,0x90,0x00,68,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSel4f06[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x4f,0x06,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x04,0x81,0x02,0x00,0x11,0x88,0x01,0x06};
 UINT8 ucRead4f06[8] = {2,0x90,0x00,4,0x00,0x00,0x00,0x00};
 UINT8 ucSel4f07[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x4f,0x07,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x02,0x81,0x02,0x00,0x0f,0x88,0x01,0x07};
 UINT8 ucRead4f07[6] = {2,0x90,0x00,2,0xa0,0x00};
 UINT8 ucSel4f0a[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x4f,0x0a,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x04,0x81,0x02,0x00,0x11,0x88,0x01,0x0a};
 UINT8 ucRead4f0a[8] = {2,0x90,0x00,4,0xf0,0xff,0x00,0x00};
 UINT8 ucVerCP[4] = {2,0x63,0xc3,0};
 UINT8 ucUnbCP[4] = {2,0x63,0xca,0};
 UINT8 ucSelAuth[4] = {2,0x90,0x00,0};
 UINT8 ucSelAuth_Error[4] = {2,0x69,0x81,0};
 UINT8 ucReadAuth[18] = {2,0x90,0x00,14,0x04,0xa6,0x85,0x73,0x7e,0x08,0xd6,0x24,0xfb,0x29,0xd7,0x35,0xda,0xb0};
 UINT8 ucSel7fff[4] = {2,0x90,0x00,0};
 UINT8 ucSel7fff_PIN_READ[61] = {2,0x90,0x00,57,0x62,0x37,0x82,0x02,0x78,0x21,0x84,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,0xa5,0x0c,0x80,0x01,0x31,0x82,0x01,0xff,0x83,0x04,0x00,0x00,0x78,0x08,0x8a,0x01,0x05,0x8b,0x03,0x2f,0x06,0x07,0xc6,0x09,0x90,0x01,0x00,0x83,0x01,0x01,0x83,0x01,0x81};
 UINT8 ucSelect_File_Fail[4] = {2,0x6A,0x82,0};
 UINT8 ucSel6f42[43] = {2,0x90,0x00,39,0x62,0x25,0x82,0x05,0x42,0x21,0x00,0x28,0x01,0x83,0x02,0x6f,0x42,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x28,0x81,0x02,0x00,0x36,0x88,0x00};
 UINT8 ucRead6f42[45] = {2,0x90,0x00,40,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x08,0x91,0x68,0x31,0x08,0x10,0x83,0x00,0xf0,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSel6f43[40] = {2,0x90,0x00,36,0x62,0x22,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x43,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x04,0x80,0x02,0x00,0x02,0x81,0x02,0x00,0x0f,0x88,0x00};
 UINT8 ucRead6f43[6] = {2,0x90,0x00,2,0x9e,0xff};
 UINT8 ucSel6f3c[43] = {2,0x90,0x00,39,0x62,0x25,0x82,0x05,0x42,0x21,0x00,0xB0,0x01,0x83,0x02,0x6f,0x3c,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0xb0,0x81,0x02,0x00,0xbd,0x88,0x00};
 UINT8 ucSel6f3c_AT_Test[43] = {2,0x90,0x00,39,0x62,0x25,0x82,0x05,0x42,0x21,0x00,0xB0,0x0a,0x83,0x02,0x6f,0x3c,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x06,0xe6,0x81,0x02,0x06,0xf3,0x88,0x00};
 UINT8 ucRead6f3c[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_Fail[4] = {2,0x6A,0x83,0};
 UINT8 ucRead6f3c_1[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_2[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_3[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_4[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_5[180] = {2,0x90,0x00,176,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_6[180] = {2,0x90,0x00,176,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_7[180] = {2,0x90,0x00,176,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_8[180] = {2,0x90,0x00,176,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_9[180] = {2,0x90,0x00,176,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f3c_10[180] = {2,0x90,0x00,176,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucSel6f47[43] = {2,0x90,0x00,39,0x62,0x25,0x82,0x05,0x42,0x21,0x00,0x1e,0x01,0x83,0x02,0x6f,0x47,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x1e,0x81,0x02,0x00,0x2b,0x88,0x00};
 UINT8 ucSel6f47_AT_Test[43] = {2,0x90,0x00,39,0x62,0x25,0x82,0x05,0x42,0x21,0x00,0x1e,0x0a,0x83,0x02,0x6f,0x47,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x01,0x2d,0x81,0x02,0x01,0x3a,0x88,0x00};
 UINT8 ucRead6f47[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_Fail[4] = {2,0x6A,0x83,0};
 UINT8 ucRead6f47_1[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_2[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_3[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_4[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_5[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_6[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_7[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_8[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_9[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
 UINT8 ucRead6f47_10[34] = {2,0x90,0x00,30,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

 UINT8 *const pUSIM6F3CATTest_tbl[] =
 {
	 ucRead6f3c_1,
	 ucRead6f3c_2,
	 ucRead6f3c_3,
	 ucRead6f3c_4,
	 ucRead6f3c_5,
	 ucRead6f3c_6,
	 ucRead6f3c_7,
	 ucRead6f3c_8,
	 ucRead6f3c_9,
	 ucRead6f3c_10
 };

 UINT8 *const pUSIM6F47ATTest_tbl[] =
 {
	 ucRead6f47_1,
	 ucRead6f47_2,
	 ucRead6f47_3,
	 ucRead6f47_4,
	 ucRead6f47_5,
	 ucRead6f47_6,
	 ucRead6f47_7,
	 ucRead6f47_8,
	 ucRead6f47_9,
	 ucRead6f47_10
 };

 UINT8 ucPinReAttemptNum = 3;                                           /* define PIN reattempt number is 2 for AT test when script start */
 UINT8 ucPucReAttemptNum = 2;                                           /* define PUK reattempt number is 2 for AT test when script start */
 UINT8 ucUsimPin[8] = {0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31};
 UINT8 ucUsimPuk[8] = {0x31,0x31,0x31,0x31,0x31,0x31,0x31,0x31};

extern char ScriptName[200];

#define EFID_REC_COUNT  29
	const UINT32 ulEfidRecIndex[EFID_REC_COUNT] = {
		0,0x2f00,0x2f08,0x2fe2,0x6f07,0x6f09,0x6f31,0x6f38,0x6f56,0x6f60,0x6f61,
		0x6f78,0x6f7b,0x6fad,0x6fd9,0x6fdb,0x6fdc,0x6fe8,0x6fec,0x4f01,0x4f03,
		0x4f05,0x4f06,0x4f07,0x4f0a,0x6f42,0x6f43,0x6f3c,0x6f47,
};

 UINT8 ucUsimAtcSmsTest = 0;
 UINT8 ucUsimAtcSmsrTest = 0;
 UINT8 ucUsimAtcSmsCnt = 0;
 UINT8 ucUsimAtcFailCnt[30] = {0};

UINT8 ucRtos32cnt = 0;
UINT8 ucPinTestCnt = 0;

UINT8 GetRTOSIndex()
{
    UINT8 ucIndex = 0;
    if((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_06"))
        || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_07"))
        || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_08"))
        || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_09"))
        )
    {
        ucIndex = 1;
    }
    else if((0 == strcmp((const char*)ScriptName,"NASMM_PT_01_01_01_03"))
        || (0 == strcmp((const char*)ScriptName,"NASMM_PT_01_01_06_01"))
        || (0 == strcmp((const char*)ScriptName,"NASMM_PT_01_01_06_02"))
        || (0 == strcmp((const char*)ScriptName,"NASMM_PT_01_01_06_03"))
        )
    {
        ucIndex = 2;
    }
	else if ((0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_02"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_04"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_05"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_08"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_10"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_11"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_12"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_13"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_02_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_01_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_01_02"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_01_03"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_01_04"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_02_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_02_05"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_03_02"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_04_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_05_01"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_05_02"))
		||(0 == strcmp((const char*)ScriptName, "NASMM_PT_08_03_05_03"))
		)
	{
		ucIndex = 3;
	}
    else if ((0 == strcmp((const char*)ScriptName, "NASMM_PT_01_02_03_04"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_01_01_04"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_01_01_06"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_01_01_08"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_01_01_10"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_01_01_14"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_03_01_01"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_03_02_02"))
        || (0 == strcmp((const char*)ScriptName, "NASMM_PT_03_03_04_02"))
        )
    {
        ucIndex = 4;
    }
	else if((0 == strcmp((const char*)ScriptName, "NASMM_PT_Register_SMS")))
	{
		ucUsimAtcFailCnt[0] = 87;
		ucUsimAtcFailCnt[1] = 89;
		ucUsimAtcFailCnt[2] = 91;
		ucUsimAtcFailCnt[3] = 94;
		ucUsimAtcFailCnt[4] = 87;
		ucUsimAtcFailCnt[5] = 96;
		ucUsimAtcFailCnt[6] = 99;
		ucUsimAtcFailCnt[7] = 100;
		ucUsimAtcFailCnt[8] = 104;
		ucUsimAtcFailCnt[9] = 105;
		ucUsimAtcFailCnt[10] = 113;
		ucUsimAtcFailCnt[11] = 117;
		ucUsimAtcFailCnt[12] = 120;
        ucIndex = 5;
	}
	// add for xiaonian
	else if((0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_07")))
	{
        ucIndex = 6;
	}
	else if((0 == strcmp((const char*)ScriptName, "NASMM_PT_08_02_01_01")))
	{
        ucIndex = 7;
	}
	else if((0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_01_09")))
	{
        ucIndex = 8;
	}
	else if((0 == strcmp((const char*)ScriptName, "NASMM_PT_08_01_02_04")))
	{
        ucIndex = 9;
	}
    else
    {
        ucIndex = 0;
    }
    return ucIndex;
}
const UINT8 ucEfidCaseNo_tbl[][25] =
{
    // 00 Other Case
    
    // 01 
    // USIM_PT_01_02_06; USIM_PT_01_02_07; USIM_PT_01_02_08; USIM_PT_01_02_09

    // 02 UE initial registration procedure for power on with a valid 5G NAS security context,and non-cleartext IEs need to send
    // NASMM_PT_01_01_01_03 
	
    // 03 UE initial registration procedure for power on,and EHPLMN,UPLMN,OPLMN are exsit in USIM
    // NASMM_PT_08_01_01_01; NASMM_PT_08_01_01_02; NASMM_PT_08_01_01_04; NASMM_PT_08_01_01_05; NASMM_PT_08_01_01_08; NASMM_PT_08_01_01_10; NASMM_PT_08_01_01_11;
	// NASMM_PT_08_01_01_12; NASMM_PT_08_01_01_13; NASMM_PT_08_03_01_01; NASMM_PT_08_03_01_02; NASMM_PT_08_03_01_03; NASMM_PT_08_03_01_04; NASMM_PT_08_03_02_01;
	// NASMM_PT_08_03_02_05; NASMM_PT_08_03_03_02; NASMM_PT_08_03_04_01; NASMM_PT_08_03_05_01; NASMM_PT_08_03_05_02; NASMM_PT_08_03_05_03;
    
    // 04 UE configured for high priority access
    // NASMM_PT_03_01_01_04;

    /*Case :  00     01     02     03 ,   04,   05,    06,    07,    08,    09
    /*00*/ { 0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00},//0,
    /*01*/ { 0x01,  0x1A,  0x01,  0x01,  0x01,  0x01,  0x01,  0x01,  0x01,  0x01},//0x2f00,
    /*02*/ { 0x02,  0x02,  0x02,  0x02,  0x02,  0x02,  0x02,  0x02,  0x02,  0x02},//0x2f08,
    /*03*/ { 0x03,  0x03,  0x03,  0x03,  0x03,  0x03,  0x03,  0x03,  0x03,  0x03},//0x2fe2,
    /*04*/ { 0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04,  0x04},//0x6f07,
    /*05*/ { 0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05,  0x05},//0x6f09,
    /*06*/ { 0x06,  0x06,  0x06,  0x06,  0x06,  0x06,  0x06,  0x06,  0x06,  0x06},//0x6f31,
    /*07*/ { 0x07,  0x07,  0x07,  0x07,  0x07,  0x25,  0x07,  0x07,  0x07,  0x07},//0x6f38,
    /*08*/ { 0x08,  0x08,  0x08,  0x08,  0x08,  0x08,  0x08,  0x08,  0x08,  0x08},//0x6f56,
    /*09*/ { 0x09,  0x09,  0x09,  0x1D,  0x09,  0x09,  0x09,  0x09,  0x28,  0x09},//0x6f60,
    /*10*/ { 0x0A,  0x0A,  0x0A,  0x1E,  0x0A,  0x0A,  0x0A,  0x0A,  0x0A,  0x0A},//0x6f61,
    /*11*/ { 0x0B,  0x0B,  0x0B,  0x0B,  0x20,  0x20,  0x0B,  0x0B,  0x0B,  0x0B},//0x6f78,
    /*12*/ { 0x0C,  0x0C,  0x0C,  0x0C,  0x0C,  0x0C,  0x0C,  0x0C,  0x0C,  0x0C},//0x6f7b,
    /*13*/ { 0x0D,  0x0D,  0x0D,  0x0D,  0x0D,  0x0D,  0x0D,  0x0D,  0x0D,  0x0D},//0x6fad,
    /*14*/ { 0x0E,  0x0E,  0x0E,  0x1F,  0x0E,  0x0E,  0x26,  0x0E,  0x0E,  0x0E},//0x6fd9,
    /*15*/ { 0x0F,  0x0F,  0x0F,  0x0F,  0x0F,  0x0F,  0x0F,  0x0F,  0x0F,  0x29},//0x6fdb,
    /*16*/ { 0x10,  0x10,  0x10,  0x10,  0x10,  0x10,  0x10,  0x27,  0x10,  0x10},//0x6fdc,
    /*17*/ { 0x11,  0x11,  0x11,  0x11,  0x11,  0x11,  0x11,  0x11,  0x11,  0x11},//0x6fe8,
    /*18*/ { 0x12,  0x12,  0x12,  0x12,  0x12,  0x12,  0x12,  0x12,  0x12,  0x12},//0x6fec,
    /*19*/ { 0x13,  0x13,  0x1C,  0x13,  0x13,  0x13,  0x13,  0x13,  0x13,  0x13},//0x4f01,
    /*20*/ { 0x14,  0x14,  0x1B,  0x14,  0x14,  0x14,  0x14,  0x14,  0x14,  0x14},//0x4f03,
    /*21*/ { 0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15,  0x15},//0x4f05,
    /*22*/ { 0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16,  0x16},//0x4f06,
    /*23*/ { 0x17,  0x17,  0x17,  0x17,  0x17,  0x17,  0x17,  0x17,  0x17,  0x17},//0x4f07,
    /*24*/ { 0x18,  0x18,  0x18,  0x18,  0x18,  0x18,  0x18,  0x18,  0x18,  0x18},//0x4f0a,
    /*25*/ { 0x21,  0x21,  0x21,  0x21,  0x21,  0x21,  0x21,  0x21,  0x21,  0x21},//0x6f42,
    /*26*/ { 0x22,  0x22,  0x22,  0x22,  0x22,  0x22,  0x22,  0x22,  0x22,  0x22},//0x6f43,
    /*27*/ { 0x23,  0x23,  0x23,  0x23,  0x23,  0x23,  0x23,  0x23,  0x23,  0x23},//0x6f3c,
    /*28*/ { 0x24,  0x24,  0x24,  0x24,  0x24,  0x24,  0x24,  0x24,  0x24,  0x24},//0x6f47,
};

UINT8 *const pUSIMRead_tbl[] =
{
    /*0x00*/ NULL,
    /*0x01*/ ucRead2f00,
    /*0x02*/ ucRead2f08,
    /*0x03*/ ucRead2fe2,
    /*0x04*/ ucRead6f07,
    /*0x05*/ ucRead6f09,
    /*0x06*/ ucRead6f31,
    /*0x07*/ ucRead6f38,
    /*0x08*/ ucRead6f56,
    /*0x09*/ ucRead6f60,
    /*0x0A*/ ucRead6f61,
    /*0x0B*/ ucRead6f78,
    /*0x0C*/ ucRead6f7b,
    /*0x0D*/ ucRead6fad,
    /*0x0E*/ ucRead6fd9,
    /*0x0F*/ ucRead6fdb,
    /*0x10*/ ucRead6fdc,
    /*0x11*/ ucRead6fe8,
    /*0x12*/ ucRead6fec,
    /*0x13*/ ucRead4f01,
    /*0x14*/ ucRead4f03,
    /*0x15*/ ucRead4f05,
    /*0x16*/ ucRead4f06,
    /*0x17*/ ucRead4f07,
    /*0x18*/ ucRead4f0a,
    /*0x19*/ ucRead6f38_ME_Calc_Suci,
    /*0x1A*/ ucRead2f00_Aid_Error,
    /*0x1B*/ ucRead4f03_Rplmn,
    /*0x1C*/ ucRead4F01_Rplmn,
	/*0x1D*/ ucRead6f60_Plmn_Search,
	/*0x1E*/ ucRead6f61_Plmn_Search,
	/*0x1F*/ ucRead6fd9_Plmn_Search,
    /*0x20*/ ucRead6f78_HighPori,
	/*0x21*/ ucRead6f42,
	/*0x22*/ ucRead6f43,
	/*0x23*/ ucRead6f3c,
	/*0x24*/ ucRead6f47,
	/*0x25*/ ucRead6f38_Sms,
	/*0x26*/ ucRead6f38_Noehplmn,
	/*0x27*/ ucRead6fdc_regist_on_last_plmn,
	/*0x28*/ ucRead6f38_NoPLMNwACT,
	/*0x29*/ ucRead6fdb_changeEHPLMNPI
};
UINT16 const ausUSIMReadLen[] =
{
    /*0x00*/ 0,
    /*0x01*/ sizeof(ucRead2f00),
    /*0x02*/ sizeof(ucRead2f08),
    /*0x03*/ sizeof(ucRead2fe2),
    /*0x04*/ sizeof(ucRead6f07),
    /*0x05*/ sizeof(ucRead6f09),
    /*0x06*/ sizeof(ucRead6f31),
    /*0x07*/ sizeof(ucRead6f38),
    /*0x08*/ sizeof(ucRead6f56),
    /*0x09*/ sizeof(ucRead6f60),
    /*0x0A*/ sizeof(ucRead6f61),
    /*0x0B*/ sizeof(ucRead6f78),
    /*0x0C*/ sizeof(ucRead6f7b),
    /*0x0D*/ sizeof(ucRead6fad),
    /*0x0E*/ sizeof(ucRead6fd9),
    /*0x0F*/ sizeof(ucRead6fdb),
    /*0x10*/ sizeof(ucRead6fdc),
    /*0x11*/ sizeof(ucRead6fe8),
    /*0x12*/ sizeof(ucRead6fec),
    /*0x13*/ sizeof(ucRead4f01),
    /*0x14*/ sizeof(ucRead4f03),
    /*0x15*/ sizeof(ucRead4f05),
    /*0x16*/ sizeof(ucRead4f06),
    /*0x17*/ sizeof(ucRead4f07),
    /*0x18*/ sizeof(ucRead4f0a),
    /*0x19*/ sizeof(ucRead6f38_ME_Calc_Suci),
    /*0x1A*/ sizeof(ucRead2f00_Aid_Error),
    /*0x1B*/ sizeof(ucRead4f03_Rplmn),
    /*0x1C*/ sizeof(ucRead4F01_Rplmn),
	/*0x1D*/ sizeof(ucRead6f60_Plmn_Search),
	/*0x1E*/ sizeof(ucRead6f61_Plmn_Search),
	/*0x1F*/ sizeof(ucRead6fd9_Plmn_Search),
    /*0x20*/ sizeof(ucRead6f78_HighPori),
	/*0x21*/ sizeof(ucRead6f42),
	/*0x22*/ sizeof(ucRead6f43),
	/*0x23*/ sizeof(ucRead6f3c),
	/*0x24*/ sizeof(ucRead6f47),
	/*0x25*/ sizeof(ucRead6f38_Sms),
	/*0x26*/ sizeof(ucRead6f38_Noehplmn)
};
VOID GetUsimResultInfoDummy(UINT8 *input_str, UINT8 *output_str, UINT32 *output_len)
{
    UINT8 i, j, k;
    UINT8 ucUSIMChooseNo;

    for(i = 0; i < EFID_REC_COUNT; i++)
    {
        if(ulEfidRec == ulEfidRecIndex[i])
        {
            break;
        }
    }
    if(EFID_REC_COUNT <= i)
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM read error in GetUsimResultInfoDummy!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy");
        return;
    }

    j = GetRTOSIndex();
    ucUSIMChooseNo = ucEfidCaseNo_tbl[i][j];
    if(NULL != pUSIMRead_tbl[ucUSIMChooseNo])
    {
        if((0 == strcmp((const char*)input_str,"4,0x00,0xb0,0x00,0x00,"))&&
            ((ulEfidRec == 0x6f07)||(ulEfidRec == 0x6f09)||(ulEfidRec == 0x6f31)||(ulEfidRec == 0x6f38)||(ulEfidRec == 0x6f56)||
             (ulEfidRec == 0x6f60)||(ulEfidRec == 0x6f61)||(ulEfidRec == 0x6f78)||(ulEfidRec == 0x6f7b)||(ulEfidRec == 0x6fad)||
             (ulEfidRec == 0x6fd9)||(ulEfidRec == 0x6fdb)||(ulEfidRec == 0x6fdc)||(ulEfidRec == 0x6fe8)||(ulEfidRec == 0x6fec)||
             (ulEfidRec == 0x2fe2)||(ulEfidRec == 0x2f08)||(ulEfidRec == 0x4f01)||(ulEfidRec == 0x4f05)||(ulEfidRec == 0x4f06)||
             (ulEfidRec == 0x4f07)||(ulEfidRec == 0x4f0a)||(ulEfidRec == 0x6f43)))
        {         
            ulEfidRec = 0;
            *output_len = ausUSIMReadLen[ucUSIMChooseNo];
            OSAdpMemCpy(output_str,pUSIMRead_tbl[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
        }
        else if((0 == strcmp((const char*)input_str,"4,0x00,0xb2,0x01,0x04,"))&&
            ((ulEfidRec == 0x2f00)||(ulEfidRec == 0x4f03)||(ulEfidRec == 0x6f42)||(ulEfidRec == 0x6f3c)||(ulEfidRec == 0x6f47)))
        {
			if (5 == j)
			{
				if ((ulEfidRec == 0x6f3c)/* && (0 == ucUsimAtcSmsTest)*/)                   /* read 6f3c when power on */
				{
					ucUsimAtcSmsTest++;
                    *output_len = 180;
                    OSAdpMemCpy(output_str,pUSIM6F3CATTest_tbl[0],*output_len, MEM_OPERATE_0_CHECK);
					ulEfidRec = 0; 
				}
				else if ((ulEfidRec == 0x6f47)/* && (0 == ucUsimAtcSmsrTest)*/)             /* read 6f47 when power on */
				{
					ucUsimAtcSmsrTest++;
                    *output_len = 34;
                    OSAdpMemCpy(output_str,pUSIM6F47ATTest_tbl[0],*output_len, MEM_OPERATE_0_CHECK);
					ulEfidRec = 0;
				}
				else
				{
					/* TBD GSH */
#if 0
					if ((ulEfidRec == 0x6f3c) || (ulEfidRec == 0x6f47))                 /* CMGW fail               */
					{
						ulEfidRec = 0;
						ucUsimAtcSmsCnt++;
						for (i = 0;i < 30;i++)
						{
							if (ucUsimAtcSmsCnt == ucUsimAtcFailCnt[i])
							{
								*output_len = sizeof(ucRead6f3c_Fail);
								OSAdpMemCpy(output_str,ucRead6f3c_Fail,sizeof(ucRead6f3c_Fail), MEM_OPERATE_0_CHECK);
								break;
							}
						}
						if (30 == i)
						{
							*output_len = ausUSIMReadLen[ucUSIMChooseNo];
							OSAdpMemCpy(output_str,pUSIMRead_tbl[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
						}
					}
					else
#endif
					{
						ulEfidRec = 0;
						*output_len = ausUSIMReadLen[ucUSIMChooseNo];
						OSAdpMemCpy(output_str,pUSIMRead_tbl[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
					}
				}
			}
			else
			{
				ulEfidRec = 0;
				*output_len = ausUSIMReadLen[ucUSIMChooseNo];
				OSAdpMemCpy(output_str,pUSIMRead_tbl[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
			}
        }
		else if (5 == j)
		{
			k = input_str[15] - 49; /* zhe gan sha ne? GSH TBD */
			if (ulEfidRec == 0x6f3c)
			{
				ucUsimAtcSmsCnt++;
/*
				for (i = 0;i < 30;i++)
				{
					if (ucUsimAtcSmsCnt == ucUsimAtcFailCnt[i])
					{
						ulEfidRec = 0;
						*output_len = sizeof(ucRead6f3c_Fail);
						OSAdpMemCpy(output_str,ucRead6f3c_Fail,sizeof(ucRead6f3c_Fail), MEM_OPERATE_0_CHECK);
						break;
					}
				}
				if (30 == i)*/
				{
/*
					if (0 == strcmp((const char*)input_str,"4,0x00,0xb2,0x0a,0x04,"))
					{
						k = 9;
						ucUsimAtcSmsTest++;
						ulEfidRec = 0;
					}*/
					if (1 <= ucUsimAtcSmsTest)
					{
						ulEfidRec = 0;
					}
					*output_len = 180;
					OSAdpMemCpy(output_str,pUSIM6F3CATTest_tbl[k],*output_len, MEM_OPERATE_0_CHECK);
				}
			}
			else if (ulEfidRec == 0x6f47)
			{
				ucUsimAtcSmsCnt++;
/*
				for (i = 0;i < 30;i++)
				{
					if (ucUsimAtcSmsCnt == ucUsimAtcFailCnt[i])
					{
						ulEfidRec = 0;
						*output_len = sizeof(ucRead6f47_Fail);
						OSAdpMemCpy(output_str,ucRead6f47_Fail,sizeof(ucRead6f47_Fail), MEM_OPERATE_0_CHECK);
						break;
					}
				}
				if (30 == i)*/
				{
/*
					if (0 == strcmp((const char*)input_str,"4,0x00,0xb2,0x0a,0x04,"))
					{
						k = 9;
						ucUsimAtcSmsrTest++;
						ulEfidRec = 0;
					}*/
					if (1 <= ucUsimAtcSmsrTest)
					{
						ulEfidRec = 0;
					}
					*output_len = 34;
					OSAdpMemCpy(output_str,pUSIM6F47ATTest_tbl[k],*output_len, MEM_OPERATE_0_CHECK);
				}
			}
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM read error in GetUsimResultInfoDummy!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy");
        }
    }
    else
    {
        /////////////USIM_SELECT////////////////
        if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x0c,0x3f,0x00,"))
        {
            *output_len = sizeof(ucSel3f00);
            OSAdpMemCpy(output_str,ucSel3f00,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x04,0x2f,0x00,"))
        {
            ulEfidRec = 0x2f00;
            *output_len = sizeof(ucSel2f00);
            OSAdpMemCpy(output_str,ucSel2f00,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"20,0x00,0xa4,0x04,0x04,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,"))
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_05"))
            {
                *output_len = sizeof(ucSelDF_Fcp_Error);
                OSAdpMemCpy(output_str,ucSelDF_Fcp_Error,*output_len, MEM_OPERATE_0_CHECK);
            }
            else if ((0 == strcmp((const char*)ScriptName,"USIM_PT_06_03_01"))
                || (0 == strcmp((const char*)ScriptName,"USIM_PT_06_05_01"))
                || (0 == strcmp((const char*)ScriptName,"USIM_PT_06_05_02"))
                )
            {
                *output_len = sizeof(ucSelDF_PIN_TEST);
                OSAdpMemCpy(output_str,ucSelDF_PIN_TEST,*output_len, MEM_OPERATE_0_CHECK);
            }
            else
            {
                *output_len = sizeof(ucSelDF);
                OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
            }
        }
        else if(0 == strcmp((const char*)input_str,"20,0x00,0xa4,0x04,0x04,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xf0,"))
        {
            *output_len = sizeof(ucSelect_File_Fail);
            OSAdpMemCpy(output_str,ucSelect_File_Fail,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"13,0x80,0x10,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0x7f,0x7f,0xff,0x7f,"))
        {
            *output_len = 0;
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x07,"))
        {
            ulEfidRec = 0x6f07;
            *output_len = sizeof(ucSel6f07);
            OSAdpMemCpy(output_str,ucSel6f07,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x09,"))
        {
            ulEfidRec = 0x6f09;
            *output_len = sizeof(ucSel6f09);
            OSAdpMemCpy(output_str,ucSel6f09,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x09,"))
        {
            ulEfidRec = 0x6f09;
            *output_len = sizeof(ucSelect_File_Fail);
            OSAdpMemCpy(output_str,ucSelect_File_Fail,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x31,"))
        {
            ulEfidRec = 0x6f31;
            *output_len = sizeof(ucSel6f31);
            OSAdpMemCpy(output_str,ucSel6f31,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x38,"))
        {
            ulEfidRec = 0x6f38;
            *output_len = sizeof(ucSel6f38);
            OSAdpMemCpy(output_str,ucSel6f38,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x56,"))
        {
            ulEfidRec = 0x6f56;
            *output_len = sizeof(ucSel6f56);
            OSAdpMemCpy(output_str,ucSel6f56,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x60,"))
        {
            ulEfidRec = 0x6f60;
            *output_len = sizeof(ucSel6f60_1);
            OSAdpMemCpy(output_str,ucSel6f60_1,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x60,"))
        {
            ulEfidRec = 0x6f60;
            *output_len = sizeof(ucSel6f60_2);
            OSAdpMemCpy(output_str,ucSel6f60_2,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x61,"))
        {
            ulEfidRec = 0x6f61;
            *output_len = sizeof(ucSel6f61);
            OSAdpMemCpy(output_str,ucSel6f61,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x78,"))
        {
            ulEfidRec = 0x6f78;
            *output_len = sizeof(ucSel6f78);
            OSAdpMemCpy(output_str,ucSel6f78,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x7b,"))
        {
            ulEfidRec = 0x6f7b;
            *output_len = sizeof(ucSel6f7b);
            OSAdpMemCpy(output_str,ucSel6f7b,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xad,"))
        {
            ulEfidRec = 0x6fad;
            *output_len = sizeof(ucSel6fad);
            OSAdpMemCpy(output_str,ucSel6fad,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xd9,"))
        {
            ulEfidRec = 0x6fd9;
            *output_len = sizeof(ucSel6fd9);
            OSAdpMemCpy(output_str,ucSel6fd9,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xdb,"))
        {
            ulEfidRec = 0x6fdb;
            *output_len = sizeof(ucSel6fdb);
            OSAdpMemCpy(output_str,ucSel6fdb,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xdc,"))
        {
            ulEfidRec = 0x6fdc;
            *output_len = sizeof(ucSel6fdc);
            OSAdpMemCpy(output_str,ucSel6fdc,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xe8,"))
        {
            ulEfidRec = 0x6fe8;
            *output_len = sizeof(ucSel6fe8);
            OSAdpMemCpy(output_str,ucSel6fe8,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xec,"))
        {
            ulEfidRec = 0x6fec;
            *output_len = sizeof(ucSel6fec);
            OSAdpMemCpy(output_str,ucSel6fec,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x5f,0xc0,0x4f,0x01,"))
        {
            ulEfidRec = 0x4f01;
            *output_len = sizeof(ucSel4f01);
            OSAdpMemCpy(output_str,ucSel4f01,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x03,"))
        {
            ulEfidRec = 0x4f03;
            *output_len = sizeof(ucSel4f03);
            OSAdpMemCpy(output_str,ucSel4f03,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x05,"))
        {
            ulEfidRec = 0x4f05;
            *output_len = sizeof(ucSel4f05);
            OSAdpMemCpy(output_str,ucSel4f05,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x06,"))
        {
            ulEfidRec = 0x4f06;
            *output_len = sizeof(ucSel4f06);
            OSAdpMemCpy(output_str,ucSel4f06,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x07,"))
        {
            ulEfidRec = 0x4f07;
            *output_len = sizeof(ucSel4f07);
            OSAdpMemCpy(output_str,ucSel4f07,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x0a,"))
        {
            ulEfidRec = 0x4f0a;
            *output_len = sizeof(ucSel4f0a);
            OSAdpMemCpy(output_str,ucSel4f0a,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x0c,0x7f,0xff,"))
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_04_01_01"))
            {
                *output_len = sizeof(ucSelAuth_Error);
                OSAdpMemCpy(output_str,ucSelAuth_Error,*output_len, MEM_OPERATE_0_CHECK);
            }
            else
            {
                *output_len = sizeof(ucSelAuth);
                OSAdpMemCpy(output_str,ucSelAuth,*output_len, MEM_OPERATE_0_CHECK);
            }

        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x2f,0xe2,"))
        {
            ulEfidRec = 0x2fe2;
            *output_len = sizeof(ucSel2fe2);
            OSAdpMemCpy(output_str,ucSel2fe2,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x2f,0x08,"))
        {
            ulEfidRec = 0x2f08;
            *output_len = sizeof(ucSel2f08);
            OSAdpMemCpy(output_str,ucSel2f08,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSel7fff);
            OSAdpMemCpy(output_str,ucSel7fff,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x04,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSelDF);
            OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x04,0x7f,0xff,"))
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_06_03_01"))
            {
                *output_len = sizeof(ucSelAuth_Error);
                OSAdpMemCpy(output_str,ucSelAuth_Error,*output_len, MEM_OPERATE_0_CHECK);
            }
            else
            {
                *output_len = sizeof(ucSelDF);
                OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
            }

        }
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x42,"))
		{
			ulEfidRec = 0x6f42;
			*output_len = sizeof(ucSel6f42);
			OSAdpMemCpy(output_str,ucSel6f42,*output_len, MEM_OPERATE_0_CHECK);
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x43,"))
		{
			ulEfidRec = 0x6f43;
			*output_len = sizeof(ucSel6f43);
			OSAdpMemCpy(output_str,ucSel6f43,*output_len, MEM_OPERATE_0_CHECK);
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x3c,"))
		{
			ulEfidRec = 0x6f3c;
			if (5 == j)
			{
				*output_len = sizeof(ucSel6f3c_AT_Test);
				OSAdpMemCpy(output_str,ucSel6f3c_AT_Test,*output_len, MEM_OPERATE_0_CHECK);
			}
			else
			{
				*output_len = sizeof(ucSel6f3c);
				OSAdpMemCpy(output_str,ucSel6f3c,*output_len, MEM_OPERATE_0_CHECK);
			}
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x47,"))
		{
			ulEfidRec = 0x6f47;
			if (5 == j)
			{
				*output_len = sizeof(ucSel6f47_AT_Test);
				OSAdpMemCpy(output_str,ucSel6f47_AT_Test,*output_len, MEM_OPERATE_0_CHECK);
			}
			else
			{
				*output_len = sizeof(ucSel6f47);
				OSAdpMemCpy(output_str,ucSel6f47,*output_len, MEM_OPERATE_0_CHECK);
			}
		}
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM select error in GetUsimResultInfoDummy!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy");
        }
    }
}

VOID UpdateUsimInfoDummy(const char *infor_header, UINT8 *input_str, UINT8 input_len)
{
    UINT8 *pEfid = NULL;
    UINT16 usSize = 0;

    if(ulEfidRec == 0)
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
    }
    if(0 == strcmp(infor_header,"4,0x00,0xb2,0x01,0x04,2,0x90,0x00,"))
    {
        if(ulEfidRec == 0x2f00)
        {
            pEfid = ucRead2f00;
        }
		else if(ulEfidRec == 0x6f42)
		{
			pEfid = ucRead6f42;
		}
		else if(ulEfidRec == 0x6f3c)
		{
			pEfid = ucRead6f3c;
		}
		else if(ulEfidRec == 0x6f47)
		{
			pEfid = ucRead6f47;
        }
        else if(ulEfidRec == 0x4f03)
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01"))
            {
                g_UiccDetectCnt++;
            }
            pEfid = ucRead4f03;
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
        }
        ulEfidRec = 0;
        if(0 != input_len)
        {
            OSAdpMemCpy(pEfid +4,input_str,input_len, MEM_OPERATE_0_CHECK);
        }
    }
    else if(0 == strcmp(infor_header,"4,0x00,0xb0,0x00,0x00,2,0x90,0x00,"))
    {
        if(ulEfidRec == 0x6f09)
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01"))
            {
                g_UiccDetectCnt++;
            }
            pEfid = ucRead6f09;
            usSize = sizeof(ucRead6f09);
        }
        else if(ulEfidRec == 0x6f60)
        {
            pEfid = ucRead6f60;
            usSize = sizeof(ucRead6f60);
        }
        else if(ulEfidRec == 0x6f7b)
        {
            pEfid = ucRead6f7b;
            usSize = sizeof(ucRead6f7b);
        }
        else if(ulEfidRec == 0x6f07)
        {
            pEfid = ucRead6f07;
            usSize = sizeof(ucRead6f07);
        }
        else if(ulEfidRec == 0x4f01)
        {
            pEfid = ucRead4f01;
            usSize = sizeof(ucRead4f01);
        }
		else if(ulEfidRec == 0x6f43)
		{
			pEfid = ucRead6f43;
			usSize = sizeof(ucRead6f43);
		}
        else if(ulEfidRec == 0x4f05)
        {
            pEfid = ucRead4f05;
            usSize = sizeof(ucRead4f05);
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
        }
        ulEfidRec = 0;
        OSAdpMemSet(pEfid + 4,0,(usSize - 4), MEM_OPERATE_0_CHECK);
        if(0 != input_len)
        {
            OSAdpMemCpy(pEfid + 4,input_str,input_len, MEM_OPERATE_0_CHECK);
        }
    }
    else
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, input string error!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
    }
}

UINT16 Dumy_usim_exchange_apdu(T_DRV_SCI_cmd_header cmd_header,
    T_DRV_SCI_data_info data_info, 
    T_DRV_SCI_result_info *result_info)
{
    UINT8 *pucInputTemp;
    UINT8 *pucInputStr;
    UINT8 *pucOutputStr;
    UINT32 output_len = 0;
    UINT16 result;
    UINT8 index = 0;
    UINT8 i = 0;
    UINT8 ucRand[17];
    UINT8 ucAutnLen = 0;
    UINT8 ucAutn[16] = {0};
    UINT8 ucMatchFlg = 0;
    UINT8 ucReadStatus[18] = {0x84,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff};
    UINT8 ucAuts[14] = {0x14,0x58,0x33,0x5c,0xc3,0x39,0x23,0xc5,0xc0,0x14,0x58,0x33,0xa3,0x3c};
    UINT8 ucPinTemp[8];
    UINT8 aucSuci_ProfileA[53] = {0x01,0x00,0xf1,0x10,0x10,0x20,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
                                          0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x81,0x18,0x32,
                                          0x18,0x2f,0x01,0x01,0x01,0x01,0x01};
/*    UINT8 aucSuci_ProfileB[55] = {0x01,0x00,0xf1,0x10,0x10,0x20,0x02,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
                                          0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x81,
                                          0x18,0x32,0x18,0x2f,0x01,0x01,0x01,0x01,0x01}; */
    if (cmd_header.ins == DRV_SCI_INS_UPDATE_RECORD)
    {
		if (0 == strcmp((const char*)ScriptName,"NASMM_PT_Register_SMS"))
		{
			if(ulEfidRec == 0)
			{
				OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
				PS_ASSERT(0, PS_ERR_FATAL_PS, AGENT_THREAD_ID, "UpdateUsimInfoDummy");
			}
			else if (0x6f3c == ulEfidRec)
			{
/*				ucUsimAtcSmsCnt++;*/
				ulEfidRec = 0;
/*
				for (i = 0;i < 30;i++)
				{
					if (ucUsimAtcSmsCnt == ucUsimAtcFailCnt[i])
					{
						return 0x6281;
					}
				}*/
				if(0 != data_info.c_data)
				{
					OSAdpMemCpy(pUSIM6F3CATTest_tbl[cmd_header.p1 - 1] + 4,data_info.data,data_info.c_data, MEM_OPERATE_0_CHECK);
				}
			}
			else if (0x6f47 == ulEfidRec)
			{
/*				ucUsimAtcSmsCnt++;*/
				ulEfidRec = 0;
/*
				for (i = 0;i < 30;i++)
				{
					if (ucUsimAtcSmsCnt == ucUsimAtcFailCnt[i])
					{
						return 0x6281;
					}
				}*/
				if(0 != data_info.c_data)
				{
					OSAdpMemCpy(pUSIM6F47ATTest_tbl[cmd_header.p1 - 1] + 4,data_info.data,data_info.c_data, MEM_OPERATE_0_CHECK);
				}
			}
			else
			{
				UpdateUsimInfoDummy("4,0x00,0xb2,0x01,0x04,2,0x90,0x00,", data_info.data, data_info.c_data);
			}
            return 0x9000;
		}
		else if ((0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01")) && (0x4f03 == ulEfidRec) && (2 == g_UiccDetectCnt))
        {
            ulEfidRec = 0;
            return 0x6A82;
        }
        else
        {
            ucSelectFlg = 0;
            UpdateUsimInfoDummy("4,0x00,0xb2,0x01,0x04,2,0x90,0x00,", data_info.data, data_info.c_data);
            return 0x9000;
        }
    }
    if ((cmd_header.ins == DRV_SCI_INS_UPDATE_BINARY) && (ucSelectFlg == 1))
    {
        if ((0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01")) && (0x6f09 == ulEfidRec) && (1 == g_UiccDetectCnt))
        {
            ulEfidRec = 0;
            return 0x6A82;
        }
        else
        {
            ucSelectFlg = 0;
            UpdateUsimInfoDummy("4,0x00,0xb0,0x00,0x00,2,0x90,0x00,", data_info.data, data_info.c_data);
            return 0x9000;
        }
    }

    if (cmd_header.ins == DRV_SCI_INS_STATUS)
    {
        if (NULL == result_info->result)
        {
            return USIM_MEMORY_PROBLEM;
        }
        ucSelectFlg = 0;
        g_UiccDetectCnt++;
        if (((0 == strcmp((const char*)ScriptName,"USIM_PT_11_01_01")) && (2 == g_UiccDetectCnt))
            || ((0 == strcmp((const char*)ScriptName,"USIM_PT_11_02_01")) && (5 == g_UiccDetectCnt))
            )
        {
            ucReadStatus[17] = 0xf1;
        }
        else if ((0 == strcmp((const char*)ScriptName,"USIM_PT_11_01_03"))
            || ((0 == strcmp((const char*)ScriptName,"USIM_PT_11_02_04")) && (2 == g_UiccDetectCnt))
            )
        {
            return 0x6A86;
        }
        result_info->c_result = 18;
        OSAdpMemCpy(result_info->result, ucReadStatus, 18, MEM_OPERATE_0_CHECK);

        return 0x9000;
    }
    if (cmd_header.ins == DRV_SCI_INS_AUTHENTICATE)
    {
        if (NULL == result_info->result)
        {
            return USIM_MEMORY_PROBLEM;
        }

        ucSelectFlg = 0;
        OSAdpMemCpy(ucRand, &data_info.data[1], 16, MEM_OPERATE_0_CHECK);
        ucAutnLen = data_info.data[17];
        if (ucAutnLen != 0)
        {
            OSAdpMemCpy(ucAutn, &data_info.data[18], ucAutnLen, MEM_OPERATE_0_CHECK);
        }
        ucMatchFlg = Usim_Authentication_Ret(ucRand, ucAutn);
        if (0xFF == ucAutn[0])
        {
            OSAdpMemCpy(aucAuts, ucAuts, 14, MEM_OPERATE_0_CHECK);
            ucMatchFlg = 1;
        }
        if (0 == strcmp((const char*)ScriptName,"USIM_PT_04_01_03"))
        {
            result_info->c_result = 16;
            result_info->result[0] = 0xDC;
            result_info->result[1] = 14;
            OSAdpMemCpy(&result_info->result[2],ucAuts,14,MEM_OPERATE_0_CHECK);
            return 0x9000;
        }
        else if (0 == strcmp((const char*)ScriptName,"USIM_PT_04_01_04"))
        {
            result_info->c_result = 16;
            result_info->result[0] = 0xAA;
            result_info->result[1] = 14;
            OSAdpMemCpy(&result_info->result[2],ucAuts,14,MEM_OPERATE_0_CHECK);
            return 0x9000;
        }
        else if (0 == strcmp((const char*)ScriptName,"USIM_PT_04_01_05"))
        {
            return 0x9862;
        }
        else if (0 == strcmp((const char*)ScriptName,"USIM_PT_04_01_06"))
        {
            return 0x9999;
        }
        switch(ucMatchFlg)
        {
        case 0:
            result_info->c_result = 52;
            result_info->result[0] = 0xDB;
            result_info->result[1] = 16;
            OSAdpMemCpy(&result_info->result[2],aucRes,16, MEM_OPERATE_0_CHECK);
            result_info->result[18] = 16;
            OSAdpMemCpy(&result_info->result[19],aucCk,16, MEM_OPERATE_0_CHECK);
            result_info->result[35] = 16;
            OSAdpMemCpy(&result_info->result[36],aucIk,16, MEM_OPERATE_0_CHECK);

            return 0x9000;
        case 1:
            result_info->c_result = 16;
            result_info->result[0] = 0xDC;
            result_info->result[1] = 14;
            OSAdpMemCpy(&result_info->result[2],aucAuts,14, MEM_OPERATE_0_CHECK);
            return 0x9000;
        case 2:
            return 0x9862;
        case 3:
            return 0xFFFF;
        default:
            return 0x0000;
        }
    }
    if (DRV_SCI_INS_UICC_SUSPEND == cmd_header.ins)
    {
        if (NULL == result_info->result)
        {
            return USIM_MEMORY_PROBLEM;
        }

        ucSelectFlg = 0;
        if(0 == cmd_header.p1)
        {//suspend
            result_info->c_result = 10;
            result_info->result[0] = 1;
            result_info->result[1] = 2;
            for (i = 0; i < 8; i++)
            {
                result_info->result[2+i] = i;
            }
            return 0x9000;
        }
        else if (1 == cmd_header.p1)
        {//resume
            return 0x9000;
        }
    }
    if (DRV_SCI_INS_MANAGE_CHANNEL == cmd_header.ins)
    {
        if (NULL == result_info->result)
        {
            return USIM_MEMORY_PROBLEM;
        }

        if(0 == cmd_header.p1)
        {
            result_info->c_result = 1;
            result_info->result[0] = 1;
            return 0x9000;
        }
        else
        {
            return 0x9000;
        }
    }
//add for PIN test start
    if ((DRV_SCI_INS_VERIFY_CHV == cmd_header.ins)
        || (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
        || (DRV_SCI_INS_CHANGE_CHV == cmd_header.ins)
        || (DRV_SCI_INS_DISABLE_CHV == cmd_header.ins)
        || (DRV_SCI_INS_ENABLE_CHV == cmd_header.ins))
    {
        if (0 == data_info.c_data)
        {
            if (DRV_SCI_INS_VERIFY_CHV == cmd_header.ins)
            {
                if (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_04"))
                {
                    return 0x6982;
                }
                else if (0x01 == cmd_header.p2)
                {
                    result = 0x63C0 + ucPinReAttemptNum;
                    return result;
                }
                else
                {
                    return 0x63C3;
                }
            }
            else
            {
                if (((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_02")) && (0x81 == cmd_header.p2))
                    || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_03"))
                    )
                {
                    return 0x6982;
                }
                else if (0x01 == cmd_header.p2)
                {
                    result = 0x63C0 + ucPucReAttemptNum;
                    return result;
                }
                else
                {
                    return 0x63CA;
                }
            }
        }
        else
        {
            if (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
            {
                OSAdpMemCpy(ucPinTemp, ucUsimPuk, 8, MEM_OPERATE_0_CHECK);
            }
            else
            {
                OSAdpMemCpy(ucPinTemp, ucUsimPin, 8, MEM_OPERATE_0_CHECK);
            }
            for(i = 0; i < 8;i++)
            {
                if (ucPinTemp[i] != data_info.data[i])
                {
                    break;
                }
            }
            if (8 == i)
            {
                if ((DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
                    || (DRV_SCI_INS_CHANGE_CHV == cmd_header.ins))
                {
                    OSAdpMemCpy(ucUsimPin, &data_info.data[8], 8, MEM_OPERATE_0_CHECK);
                }
                else if (DRV_SCI_INS_DISABLE_CHV == cmd_header.ins)
                {
                    ucSelDF[54] &= 0x7F;
                }
                else if (DRV_SCI_INS_ENABLE_CHV == cmd_header.ins)
                {
                    ucSelDF[54] |= 0x80;
                }
                ucPinReAttemptNum = 3;
                ucPucReAttemptNum = 10;
                return 0x9000;
            }
            else
            {
                if (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
                {
                    if (0 == strcmp((const char*)ScriptName,"USIM_PT_06_05_02"))
                    {
                        ucPucReAttemptNum = 0;
                    }
                    if (0 != ucPucReAttemptNum)
                    {
                        ucPucReAttemptNum --;
                        result = 0x63C0 + ucPucReAttemptNum;
                        return result;
                    }
                    else
                    {
                        return 0x6983;
                    }
                }
                else
                {
                    if (0 != ucPinReAttemptNum)
                    {
                        ucPinReAttemptNum --;
                        result = 0x63C0 + ucPinReAttemptNum;
                        return result;
                    }
                    else
                    {
                        return 0x6983;
                    }
                }
            }
        }
    }

    if (DRV_SCI_INS_GET_IDENTITY == cmd_header.ins)
    {
        if (NULL == result_info->result)
        {
            return USIM_MEMORY_PROBLEM;
        }

        result_info->c_result = 55;
        result_info->result[0] = 0xA1;
        result_info->result[1] = 53;
        OSAdpMemCpy(&result_info->result[2], aucSuci_ProfileA, 53, MEM_OPERATE_0_CHECK);
        return 0x9000;
    }
//add for PIN test end
    pucInputStr = (UINT8*)PsMalloc(200, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucInputStr, 0, 200, MEM_OPERATE_0_CHECK);
    *(pucInputStr + index) = (((data_info.c_data + 4)/10) * 16) >> 4;
    if (*(pucInputStr + index) > 0)
    {
        *(pucInputStr + index++) += 48;
    }

    *(pucInputStr + index++) = ((data_info.c_data + 4)%10) + 48;
    pucInputTemp = (UINT8*)PsMalloc(100, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucInputTemp, 0, 100, MEM_OPERATE_0_CHECK);
    *(pucInputTemp) = cmd_header.cla;
    *(pucInputTemp + 1) = cmd_header.ins;
    *(pucInputTemp + 2) = cmd_header.p1;
    *(pucInputTemp + 3) = cmd_header.p2;
    if (0 != data_info.c_data)
    {
        OSAdpMemCpy((pucInputTemp + 4), data_info.data, data_info.c_data, MEM_OPERATE_0_CHECK);
    }


    for (i=0; i < data_info.c_data + 4; i++)
    {
        *(pucInputStr + index++) = ',';
        *(pucInputStr + index++) = '0';
        *(pucInputStr + index++) = 'x';
        *(pucInputStr + index) = *(pucInputTemp + i) >> 4;
        if (*(pucInputStr + index) > 9)
        {
            *(pucInputStr + index++) += 87;
        }
        else
        {
            *(pucInputStr + index++) += 48;
        }
        *(pucInputStr + index) = *(pucInputTemp + i)&0x0F;
        if (*(pucInputStr + index) > 9)
        {
            *(pucInputStr + index++) += 87;
        }
        else
        {
            *(pucInputStr + index++) += 48;
        }
    }
    PsFree(pucInputTemp);
    *(pucInputStr + index++) = ',';
    *(pucInputStr + index++) = '\0';

    pucOutputStr = (UINT8*)PsMalloc(500, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucOutputStr, 0, 500, MEM_OPERATE_0_CHECK);
    if (cmd_header.ins == DRV_SCI_INS_SELECT)
    {
        ucSelectFlg = 1;
    }
    else
    {
        ucSelectFlg = 0;
    }
    GetUsimResultInfoDummy(pucInputStr, pucOutputStr, &output_len);
    result_info->c_result = *(pucOutputStr + 3);
    result = *(pucOutputStr + 1);
    result = result << 8;
    result += *(pucOutputStr + 2);

    if (0 != *(pucOutputStr + 3))
    {
        OSAdpMemCpy(result_info->result, (pucOutputStr + 4), *(pucOutputStr + 3), MEM_OPERATE_0_CHECK);
    }

    PsFree(pucInputStr);
    PsFree(pucOutputStr);

    if (result == 0)
    {
        result = 0x9404;
    }

    return result;
}

VOID DumyUsim_init()
{

}

VOID DumyUsim_init_Restart()
{

}

UINT8 Dummy_usim_reset ()
{
    ucTestCnt ++;
    if ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_01_02"))
        || ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_07")) && (2 == ucTestCnt))
        )
    {
        return DRV_SCI_RETURN_CODE_CARD_NOT_INSERTED;
    }
    else if ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_01_03"))
        || ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_08")) && (2 == ucTestCnt))
        )
    {
        return DRV_SCI_RETURN_CODE_INVALID_CARD;
    }
    else if ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_01_04"))
        || ((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_09")) && (2 == ucTestCnt))
        )
    {
        return DRV_SCI_RETURN_CODE_ME_FAILURE;
    }
    else if((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_06"))
        || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_10"))
        )
    {
        return DRV_SCI_RETURN_CODE_CARD_INSERTED;
    }
    else
    {
        return DRV_SCI_RETURN_CODE_DUMMY_TEST_SIM;
    }
}

#endif


/*******************************************************************************************************/
#ifdef START_MODE_ST
#define EFID_REC_COUNT_ST  29
const UINT32 ulEfidRecIndex_ST[EFID_REC_COUNT_ST] = {
    0,0x2f00,0x2f08,0x2fe2,0x6f07,0x6f09,0x6f31,0x6f38,0x6f56,0x6f60,0x6f61,
    0x6f78,0x6f7b,0x6fad,0x6fd9,0x6fdb,0x6fdc,0x6fe8,0x6fec,0x4f01,0x4f03,
    0x4f05,0x4f06,0x4f07,0x4f0a,0x6f42,0x6f43,0x6f3c,0x6f47,
};
#if 1
//below is 5G TTCN test special USIM data
// Usim_P01.txt
UINT8 ucSel6f38_UsimP01[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x38,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x0a,0x81,0x02,0x00,0x16,0x88,0x01,0x20};
UINT8 ucRead6f38_UsimP01[14] = {2,0x90,0x00,10,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x00,0x03};
UINT8 ucRead6f62_UsimP01[14] = {2,0x90,0x00,10,0x00,0xf1,0x10,0x58,0x1c,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f60_UsimP01[44] = {2,0x90,0x00,40,0x12,0xf1,0x12,0xf0,0x1c,0x00,0xf1,0x13,0xf0,0x1c,0x00,0xf1,0x12,0x58,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f61_UsimP01[64] = {2,0x90,0x00,60,0x00,0xf1,0x11,0xf0,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f31_UsimP01[5] = {2,0x90,0x00,1,0x01};

// Usim_P02.txt
UINT8 ucSel6f38_UsimP02[41] = {2,0x90,0x00,37,0x62,0x23,0x82,0x02,0x41,0x21,0x83,0x02,0x6f,0x38,0xa5,0x06,0x80,0x01,0x31,0xc0,0x01,0x00,0x8a,0x01,0x05,0x8b,0x03,0x6f,0x06,0x03,0x80,0x02,0x00,0x0c,0x81,0x02,0x00,0x16,0x88,0x01,0x20};
UINT8 ucRead6f38_UsimP02[16] = {2,0x90,0x00,12,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x43,0x00,0x80};
UINT8 ucRead6f60_UsimP02[39] = {2,0x90,0x00,35,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f31_UsimP02[5] = {2,0x90,0x00,1,0x01};
UINT8 ucRead6fe3_UsimP02[22] = {2,0x90,0x00,18,0x0b,0xf6,0x00,0xf4,0x13,0x80,0x01,0x01,0x28,0x52,0xd2,0xa4,0x00,0xf4,0x13,0x00,0x01,0x00};
UINT8 ucRead6fdc_UsimP02[5] = {0x02,0x90,0x00,0x01,0x01};
UINT8 ucRead6fd9_UsimP02[16] = {2,0x90,0x00,12,0x00,0xf1,0x11,0x00,0xf1,0x10,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P03.txt
UINT8 ucRead6fe3_UsimP03[22] = {2,0x90,0x00,18,0x0b,0xf6,0x00,0xf4,0x13,0x80,0x01,0x01,0x28,0x52,0xd2,0xa4,0x00,0xf4,0x13,0x00,0x01,0x00};
UINT8 ucRead6f60_UsimP03[39] = {2,0x90,0x00,35,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP03[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x43,0x10,0x80,0x01,0x08,0x30,0x7e,0x00};
UINT8 ucRead6fd9_UsimP03[16] = {2,0x90,0x00,12,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6fdc_UsimP03[5] = {0x02,0x90,0x00,0x01,0x01};

// Usim_P04.txt
UINT8 ucRead6f61_UsimP04[49] = {2,0x90,0x00,45,0x00,0xf3,0x12,0xf0,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP04[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x4e,0x00,0x00,0x42,0x43,0x10,0x80,0x01,0x08,0x30,0x7e,0x00};
UINT8 ucRead6f60_UsimP04[44] = {2,0x90,0x00,40,0x00,0xf2,0x11,0xf8,0x1c,0x00,0xf2,0x18,0x70,0x1c,0x00,0xf1,0x12,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P05.txt
UINT8 ucRead6fe3_UsimP05[22] = {2,0x90,0x00,18,0x0b,0xf6,0x00,0xf4,0x13,0x80,0x01,0x01,0x28,0x52,0xd2,0xa4,0x00,0xf4,0x13,0x00,0x01,0x00};
UINT8 ucRead6f60_UsimP05[39] = {2,0x90,0x00,35,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP05[14] = {2,0x90,0x00,10,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x00,0x03};
UINT8 ucRead6fd9_UsimP05[16] = {2,0x90,0x00,12,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P06.txt
UINT8 ucRead6f61_UsimP06[49] = {2,0x90,0x00,45,0x00,0xf2,0x11,0xf8,0x1c,0x00,0xf4,0x13,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6fe3_UsimP06[22] = {2,0x90,0x00,18,0x0b,0xf6,0x00,0x01,0x10,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xf1,0x10,0x00,0x01,0x00};
UINT8 ucRead6f07_UsimP06[13] = {2,0x90,0x00,9,0x08,0x09,0x30,0x12,0x10,0x32,0x54,0x06,0x36};
UINT8 ucRead6f38_UsimP06[14] = {2,0x90,0x00,10,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x00,0x03};

// Usim_P07.txt
UINT8 ucRead6f61_UsimP07[49] = {2,0x90,0x00,45,0x00,0xf2,0x11,0xf0,0x1c,0x00,0xf2,0x19,0x70,0xff,0x00,0xf2,0x18,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f60_UsimP07[44] = {2,0x90,0x00,40,0x00,0xf2,0x18,0xf8,0x1c,0x00,0xf2,0x18,0x70,0x1c,0x00,0xf1,0x12,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};


// Usim_P08.txt
UINT8 ucRead6f61_UsimP08[49] = {2,0x90,0x00,45,0x00,0xf1,0x11,0xf8,0x1c,0x00,0xf1,0x11,0x70,0xff,0x00,0xf1,0x13,0x70,0xff,0x00,0xf1,0x12,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P09.txt
UINT8 ucRead6f60_UsimP09[39] = {2,0x90,0x00,35,0x00,0xf1,0x10,0xf8,0xff,0x00,0xf1,0x11,0x70,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f31_UsimP09[5] = {2,0x90,0x00,1,0x01};

// Usim_P10.txt
UINT8 ucRead6f61_UsimP10[49] = {2,0x90,0x00,45,0x00,0xf2,0x19,0xf8,0x1c,0x00,0xf2,0x18,0x70,0xff,0x00,0xf2,0x11,0x70,0xff,0x00,0xf1,0x12,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP10[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x02};
UINT8 ucRead6f31_UsimP10[5] = {2,0x90,0x00,1,0x01};

// Usim_P11.txt
UINT8 ucRead6fe3_UsimP11[22] = {2,0x90,0x00,18,0x0b,0xf6,0x00,0x01,0x10,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0x00,0xf1,0x10,0x00,0x01,0x00};
UINT8 ucRead6f07_UsimP11[13] = {2,0x90,0x00,9,0x08,0x09,0x10,0x12,0x48,0x11,0x83,0x21,0x83};
UINT8 ucRead6f60_UsimP11[39] = {2,0x90,0x00,35,0x00,0xf1,0x10,0xf8,0xff,0x00,0xf1,0x11,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f61_UsimP11[49] = {2,0x90,0x00,45,0x00,0xf1,0x10,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f62_UsimP11[14] = {2,0x90,0x00,10,0x00,0xf1,0x12,0x58,0x1c,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP11[16] = {2,0x90,0x00,12,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x00,0x03,0x00,0x80};
UINT8 ucRead6f31_UsimP11[5] = {2,0x90,0x00,1,0x01};
UINT8 ucRead6fe8_UsimP11[50] = {2,0x90,0x00,46,0x80,0x01,0x00,0x81,0x01,0x00,0x82,0x01,0x00,0x83,0x01,0x07,0x84,0x01,0x00,0x85,0x01,0x00,0x86,0x01,0x00,0x87,0x01,0x00,0x88,0x01,0x01,0x89,0x01,0x00,0x8A,0x01,0xAC,0x8B,0x01,0x00,0x8C,0x02,0x00,0x00,0x8D,0x01,0x01,0x8E,0x01,0x00};

// Usim_P12.txt
UINT8 ucRead6f60_UsimP12[39] = {2,0x90,0x00,35,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00,0xff,0xff,0xff,0x00,0x00};
UINT8 ucRead6f61_UsimP12[49] = {2,0x90,0x00,45,0x00,0xf2,0x11,0xf8,0x1c,0x00,0xf2,0x18,0x70,0xff,0x00,0xf2,0x18,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P13.txt
UINT8 ucRead6f61_UsimP13[49] = {2,0x90,0x00,45,0x00,0xf2,0x11,0xf8,0x1c,0x00,0xf2,0x11,0x70,0xff,0x00,0xf2,0x18,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P15.txt
UINT8 ucRead6f7b_UsimP15[16] = {2,0x90,0x00,12,0x00,0xf2,0x11,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};

// Usim_P17.txt
UINT8 ucRead6f60_UsimP17[39] = {2,0x90,0x00,35,0x00,0xf1,0x10,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP17[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x04};
UINT8 ucRead4f06_UsimP17[8] = {2,0x90,0x00,4,0x03,0x00,0x00,0x00};
UINT8 ucRead6f78_UsimP17[6] = {2,0x90,0x00,2,0xf8,0x00};

// Usim_P18.txt
UINT8 ucRead6f60_UsimP18[39] = {2,0x90,0x00,35,0x00,0xf2,0x11,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f62_UsimP18[14] = {2,0x90,0x00,10,0x00,0xf1,0x10,0x58,0x1c,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP18[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x04};
UINT8 ucRead6f78_UsimP18[6] = {2,0x90,0x00,2,0x01,0x00};
UINT8 ucRead4f06_UsimP18[8] = {2,0x90,0x00,4,0x01,0x00,0x00,0x00};

// Usim_P19.txt
UINT8 ucRead6f60_UsimP19[39] = {2,0x90,0x00,35,0x00,0xf2,0x11,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f62_UsimP19[14] = {2,0x90,0x00,10,0x00,0xf1,0x10,0x58,0x1c,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP19[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x04};
UINT8 ucRead6f78_UsimP19[6] = {2,0x90,0x00,2,0x01,0x00};
UINT8 ucRead4f06_UsimP19[8] = {2,0x90,0x00,4,0x01,0x00,0x00,0x00};

// Usim_P20.txt


// Usim_P21.txt
UINT8 ucRead6f61_UsimP21[49] = {2,0x90,0x00,45,0x00,0xf2,0x19,0xf8,0x1c,0x00,0xf2,0x18,0xf8,0x1c,0x00,0xf2,0x11,0xf8,0x1c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff};
UINT8 ucRead6f38_UsimP21[21] = {2,0x90,0x00,17,0x84,0x7f,0x1b,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x3e,0x02};
UINT8 ucRead6f31_UsimP21[5] = {2,0x90,0x00,1,0x01};

// Usim_P22.txt
UINT8 ucRead6f38_UsimP22[21] = {2,0x90,0x00,17,0x84,0x7f,0x1d,0x1c,0x23,0x0e,0x00,0x00,0x40,0x03,0x10,0x80,0x01,0x08,0x30,0x7e,0x04};

#endif


const UINT8 ucEfidCaseNo_tbl_ST[][25] =
{
    //00 Other Case
    //01 TTCN_6_1_1_1 TTCN_6_4_1_1
    //02 TTCN_6_1_1_7_1 TTCN_6_1_1_8_1
    //03 TTCN_6_1_1_7_2 TTCN_6_1_1_8_2
    //04 TTCN_6_1_1_2
    //05 TTCN_6_1_1_4
    //06 TTCN_6_1_1_5
    //07 USIM_P07
    //08 USIM_P08
    //09 USIM_P09
    //10 TTCN_6_3_1_1 TTCN_6_3_1_2 TTCN_6_3_1_3 TTCN_6_3_1_4
    //11 USIM_P11
    //12 USIM_P12
    //13 USIM_P13
    //15 USIM_P15
    //16 USIM_P16
    //17 TTCN_6_1_2_14
    //18 USIM_P18
    //19 USIM_P19
    //20 USIM_P20
    //21 USIM_P21
    //22 TTCN_9_1_4_1

    /*Case : 00    01    02    03    04    05    06    07    08    09    10    11    12    13    14    15    16    17    18    19    20    21    22
    /*00*/ { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},//0,
    /*01*/ { 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01},//0x2f00,
    /*02*/ { 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02},//0x2f08,
    /*03*/ { 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03},//0x2fe2,
    /*04*/ { 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x31, 0x04, 0x04, 0x04, 0x04, 0x3B, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04},//0x6f07,
    /*05*/ { 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05},//0x6f09,
    /*06*/ { 0x06, 0x1D, 0x20, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x36, 0x39, 0x40, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x56, 0x06},//0x6f31,
    /*07*/ { 0x07, 0x19, 0x1E, 0x26, 0x2A, 0x2D, 0x58, 0x07, 0x07, 0x07, 0x38, 0x3F, 0x07, 0x07, 0x07, 0x07, 0x07, 0x47, 0x4C, 0x51, 0x07, 0x55, 0x57},//0x6f38,
    /*08*/ { 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08},//0x6f56,
    /*09*/ { 0x09, 0x1B, 0x1F, 0x25, 0x59, 0x2C, 0x09, 0x33, 0x09, 0x09, 0x09, 0x3C, 0x42, 0x09, 0x09, 0x09, 0x09, 0x46, 0x4A, 0x4F, 0x09, 0x09, 0x09},//0x6f60,
    /*10*/ { 0x0A, 0x1C, 0x0A, 0x0A, 0x29, 0x0A, 0x2F, 0x32, 0x34, 0x35, 0x37, 0x3D, 0x43, 0x44, 0x0A, 0x0A, 0x0A, 0x0A, 0x0A, 0x0A, 0x0A, 0x54, 0x0A},//0x6f61,
    /*11*/ { 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x49, 0x4D, 0x52, 0x0B, 0x0B, 0x0B},//0x6f78,
    /*12*/ { 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x45, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C},//0x6f7b,
    /*13*/ { 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D, 0x0D},//0x6fad,
    /*14*/ { 0x0E, 0x0E, 0x23, 0x27, 0x0E, 0x2E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E, 0x0E},//0x6fd9,
    /*15*/ { 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F},//0x6fdb,
    /*16*/ { 0x10, 0x10, 0x22, 0x28, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10},//0x6fdc,
    /*17*/ { 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x41, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11},//0x6fe8,
    /*18*/ { 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12},//0x6fec,
    /*19*/ { 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13},//0x4f01,
    /*20*/ { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14},//0x4f03,
    /*21*/ { 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15},//0x4f05,
    /*22*/ { 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16},//0x4f06,
    /*23*/ { 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17},//0x4f07,
    /*24*/ { 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18},//0x4f0a,
    /*25*/ { 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59, 0x59},//0x6f42,
    /*26*/ { 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60},//0x6f43,
    /*27*/ { 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61},//0x6f3c,
    /*28*/ { 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62, 0x62},//0x6f47,
};

UINT8 *const pUSIMRead_tbl_ST[] =
{
    /*0x00*/ NULL,
    /*0x01*/ ucRead2f00,
    /*0x02*/ ucRead2f08,
    /*0x03*/ ucRead2fe2,
    /*0x04*/ ucRead6f07,
    /*0x05*/ ucRead6f09,
    /*0x06*/ ucRead6f31,
    /*0x07*/ ucRead6f38,
    /*0x08*/ ucRead6f56,
    /*0x09*/ ucRead6f60,
    /*0x0A*/ ucRead6f61,
    /*0x0B*/ ucRead6f78,
    /*0x0C*/ ucRead6f7b,
    /*0x0D*/ ucRead6fad,
    /*0x0E*/ ucRead6fd9,
    /*0x0F*/ ucRead6fdb,
    /*0x10*/ ucRead6fdc,
    /*0x11*/ ucRead6fe8,
    /*0x12*/ ucRead6fec,
    /*0x13*/ ucRead4f01,
    /*0x14*/ ucRead4f03,
    /*0x15*/ ucRead4f05,
    /*0x16*/ ucRead4f06,
    /*0x17*/ ucRead4f07,
    /*0x18*/ ucRead4f0a,
    /*0x19*/ ucRead6f38_UsimP01,
    /*0x1A*/ ucRead6f62_UsimP01,//
    /*0x1B*/ ucRead6f60_UsimP01,
    /*0x1C*/ ucRead6f61_UsimP01,
    /*0x1D*/ ucRead6f31_UsimP01,
    /*0x1E*/ ucRead6f38_UsimP02,
    /*0X1F*/ ucRead6f60_UsimP02,
    /*0x20*/ ucRead6f31_UsimP02,
    /*0x21*/ ucRead6fe3_UsimP02,//
    /*0x22*/ ucRead6fdc_UsimP02,
    /*0x23*/ ucRead6fd9_UsimP02,
    /*0x24*/ ucRead6fe3_UsimP03,//
    /*0x25*/ ucRead6f60_UsimP03,
    /*0x26*/ ucRead6f38_UsimP03,
    /*0x27*/ ucRead6fd9_UsimP03,
    /*0x28*/ ucRead6fdc_UsimP03,
    /*0x29*/ ucRead6f61_UsimP04,
    /*0x2A*/ ucRead6f38_UsimP04,
    /*0x2B*/ ucRead6fe3_UsimP05,//
    /*0x2C*/ ucRead6f60_UsimP05,
    /*0x2D*/ ucRead6f38_UsimP05,
    /*0x2E*/ ucRead6fd9_UsimP05,
    /*0X2F*/ ucRead6f61_UsimP06,
    /*0x30*/ ucRead6fe3_UsimP06,//
    /*0x31*/ ucRead6f07_UsimP06,
    /*0x32*/ ucRead6f61_UsimP07,
    /*0x33*/ ucRead6f60_UsimP07,
    /*0x34*/ ucRead6f61_UsimP08,
    /*0x35*/ ucRead6f60_UsimP09,
    /*0x36*/ ucRead6f31_UsimP09,
    /*0x37*/ ucRead6f61_UsimP10,
    /*0x38*/ ucRead6f38_UsimP10,
    /*0x39*/ ucRead6f31_UsimP10,
    /*0x3A*/ ucRead6fe3_UsimP11,//
    /*0x3B*/ ucRead6f07_UsimP11,
    /*0x3C*/ ucRead6f60_UsimP11,
    /*0x3D*/ ucRead6f61_UsimP11,
    /*0x3E*/ ucRead6f62_UsimP11,//
    /*0X3F*/ ucRead6f38_UsimP11,
    /*0x40*/ ucRead6f31_UsimP11,
    /*0x41*/ ucRead6fe8_UsimP11,
    /*0x42*/ ucRead6f60_UsimP12,
    /*0x43*/ ucRead6f61_UsimP12,
    /*0x44*/ ucRead6f61_UsimP13,
    /*0x45*/ ucRead6f7b_UsimP15,
    /*0x46*/ ucRead6f60_UsimP17,
    /*0x47*/ ucRead6f38_UsimP17,
    /*0x48*/ ucRead4f06_UsimP17,//
    /*0x49*/ ucRead6f78_UsimP17,
    /*0x4A*/ ucRead6f60_UsimP18,
    /*0x4B*/ ucRead6f62_UsimP18,//
    /*0x4C*/ ucRead6f38_UsimP18,
    /*0x4D*/ ucRead6f78_UsimP18,
    /*0x4E*/ ucRead4f06_UsimP18,//
    /*0X4F*/ ucRead6f60_UsimP19,
    /*0x50*/ ucRead6f62_UsimP19,//
    /*0x51*/ ucRead6f38_UsimP19,
    /*0x52*/ ucRead6f78_UsimP19,
    /*0x53*/ ucRead4f06_UsimP19,//
    /*0x54*/ ucRead6f61_UsimP21,
    /*0x55*/ ucRead6f38_UsimP21,
    /*0x56*/ ucRead6f31_UsimP21,
    /*0x57*/ ucRead6f38_UsimP22,
    /*0x58*/ ucRead6f38_UsimP06,
    /*0x59*/ ucRead6f60_UsimP04,
    /*0x59*/ ucRead6f42,
	/*0x60*/ ucRead6f43,
	/*0x61*/ ucRead6f3c,
	/*0x62*/ ucRead6f47
};

UINT16 const ausUSIMReadLen_ST[] =
{
    /*0x00*/ 0,
    /*0x01*/ sizeof(ucRead2f00),
    /*0x02*/ sizeof(ucRead2f08),
    /*0x03*/ sizeof(ucRead2fe2),
    /*0x04*/ sizeof(ucRead6f07),
    /*0x05*/ sizeof(ucRead6f09),
    /*0x06*/ sizeof(ucRead6f31),
    /*0x07*/ sizeof(ucRead6f38),
    /*0x08*/ sizeof(ucRead6f56),
    /*0x09*/ sizeof(ucRead6f60),
    /*0x0A*/ sizeof(ucRead6f61),
    /*0x0B*/ sizeof(ucRead6f78),
    /*0x0C*/ sizeof(ucRead6f7b),
    /*0x0D*/ sizeof(ucRead6fad),
    /*0x0E*/ sizeof(ucRead6fd9),
    /*0x0F*/ sizeof(ucRead6fdb),
    /*0x10*/ sizeof(ucRead6fdc),
    /*0x11*/ sizeof(ucRead6fe8),
    /*0x12*/ sizeof(ucRead6fec),
    /*0x13*/ sizeof(ucRead4f01),
    /*0x14*/ sizeof(ucRead4f03),
    /*0x15*/ sizeof(ucRead4f05),
    /*0x16*/ sizeof(ucRead4f06),
    /*0x17*/ sizeof(ucRead4f07),
    /*0x18*/ sizeof(ucRead4f0a),
    /*0x19*/ sizeof(ucRead6f38_UsimP01),
    /*0x1A*/ sizeof(ucRead6f62_UsimP01),//
    /*0x1B*/ sizeof(ucRead6f60_UsimP01),
    /*0x1C*/ sizeof(ucRead6f61_UsimP01),
    /*0x1D*/ sizeof(ucRead6f31_UsimP01),
    /*0x1E*/ sizeof(ucRead6f38_UsimP02),
    /*0X1F*/ sizeof(ucRead6f60_UsimP02),
    /*0x20*/ sizeof(ucRead6f31_UsimP02),
    /*0x21*/ sizeof(ucRead6fe3_UsimP02),//
    /*0x22*/ sizeof(ucRead6fdc_UsimP02),
    /*0x23*/ sizeof(ucRead6fd9_UsimP02),
    /*0x24*/ sizeof(ucRead6fe3_UsimP03),//
    /*0x25*/ sizeof(ucRead6f60_UsimP03),
    /*0x26*/ sizeof(ucRead6f38_UsimP03),
    /*0x27*/ sizeof(ucRead6fd9_UsimP03),
    /*0x28*/ sizeof(ucRead6fdc_UsimP03),
    /*0x29*/ sizeof(ucRead6f61_UsimP04),
    /*0x2A*/ sizeof(ucRead6f38_UsimP04),
    /*0x2B*/ sizeof(ucRead6fe3_UsimP05),//
    /*0x2C*/ sizeof(ucRead6f60_UsimP05),
    /*0x2D*/ sizeof(ucRead6f38_UsimP05),
    /*0x2E*/ sizeof(ucRead6fd9_UsimP05),
    /*0X2F*/ sizeof(ucRead6f61_UsimP06),
    /*0x30*/ sizeof(ucRead6fe3_UsimP06),//
    /*0x31*/ sizeof(ucRead6f07_UsimP06),
    /*0x32*/ sizeof(ucRead6f61_UsimP07),
    /*0x33*/ sizeof(ucRead6f60_UsimP07),
    /*0x34*/ sizeof(ucRead6f61_UsimP08),
    /*0x35*/ sizeof(ucRead6f60_UsimP09),
    /*0x36*/ sizeof(ucRead6f31_UsimP09),
    /*0x37*/ sizeof(ucRead6f61_UsimP10),
    /*0x38*/ sizeof(ucRead6f38_UsimP10),
    /*0x39*/ sizeof(ucRead6f31_UsimP10),
    /*0x3A*/ sizeof(ucRead6fe3_UsimP11),//
    /*0x3B*/ sizeof(ucRead6f07_UsimP11),
    /*0x3C*/ sizeof(ucRead6f60_UsimP11),
    /*0x3D*/ sizeof(ucRead6f61_UsimP11),
    /*0x3E*/ sizeof(ucRead6f62_UsimP11),//
    /*0X3F*/ sizeof(ucRead6f38_UsimP11),
    /*0x40*/ sizeof(ucRead6f31_UsimP11),
    /*0x41*/ sizeof(ucRead6fe8_UsimP11),
    /*0x42*/ sizeof(ucRead6f60_UsimP12),
    /*0x43*/ sizeof(ucRead6f61_UsimP12),
    /*0x44*/ sizeof(ucRead6f61_UsimP13),
    /*0x45*/ sizeof(ucRead6f7b_UsimP15),
    /*0x46*/ sizeof(ucRead6f60_UsimP17),
    /*0x47*/ sizeof(ucRead6f38_UsimP17),
    /*0x48*/ sizeof(ucRead4f06_UsimP17),//
    /*0x49*/ sizeof(ucRead6f78_UsimP17),
    /*0x4A*/ sizeof(ucRead6f60_UsimP18),
    /*0x4B*/ sizeof(ucRead6f62_UsimP18),//
    /*0x4C*/ sizeof(ucRead6f38_UsimP18),
    /*0x4D*/ sizeof(ucRead6f78_UsimP18),
    /*0x4E*/ sizeof(ucRead4f06_UsimP18),//
    /*0X4F*/ sizeof(ucRead6f60_UsimP19),
    /*0x50*/ sizeof(ucRead6f62_UsimP19),//
    /*0x51*/ sizeof(ucRead6f38_UsimP19),
    /*0x52*/ sizeof(ucRead6f78_UsimP19),
    /*0x53*/ sizeof(ucRead4f06_UsimP19),//
    /*0x54*/ sizeof(ucRead6f61_UsimP21),
    /*0x55*/ sizeof(ucRead6f38_UsimP21),
    /*0x56*/ sizeof(ucRead6f31_UsimP21),
    /*0x57*/ sizeof(ucRead6f38_UsimP22),
    /*0x58*/ sizeof(ucRead6f38_UsimP06),
    /*0x59*/ sizeof(ucRead6f60_UsimP04),
    /*0x59*/ sizeof(ucRead6f42),
    /*0x60*/ sizeof(ucRead6f43),
    /*0x61*/ sizeof(ucRead6f3c),
    /*0x62*/ sizeof(ucRead6f47)
};

UINT8 GetRTOSIndex_ST()
{
    UINT8 ucIndex = 0;
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_01"))
        )
    {
        ucIndex = 1;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_02"))
        )
    {
        ucIndex = 2;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_03"))
        )
    {
        ucIndex = 3;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_04"))
        )
    {
        ucIndex = 4;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_05"))
        )
    {
        ucIndex = 5;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_06"))
        )
    {
        ucIndex = 6;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_10"))
        )
    {
        ucIndex = 10;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_17"))
        )
    {
        ucIndex = 17;
    }
    if((0 == strcmp((const char*)ScriptName_ST,"USIM_22"))
        )
    {
        ucIndex = 22;
    }

    return ucIndex;
}

VOID GetUsimResultInfoDummy_ST(UINT8 *input_str, UINT8 *output_str, UINT32 *output_len)
{
    UINT8 i, j;
    UINT8 ucUSIMChooseNo;

    for(i = 0; i < EFID_REC_COUNT_ST; i++)
    {
        if(ulEfidRec == ulEfidRecIndex_ST[i])
        {
            break;
        }
    }
    if(EFID_REC_COUNT_ST <= i)
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM read error in GetUsimResultInfoDummy_ST!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy_ST");
        return;
    }

    j = GetRTOSIndex_ST();
    ucUSIMChooseNo = ucEfidCaseNo_tbl_ST[i][j];
    if(NULL != pUSIMRead_tbl_ST[ucUSIMChooseNo])
    {
        if((0 == strcmp((const char*)input_str,"4,0x00,0xb0,0x00,0x00,"))&&
            ((ulEfidRec == 0x6f07)||(ulEfidRec == 0x6f09)||(ulEfidRec == 0x6f31)||(ulEfidRec == 0x6f38)||(ulEfidRec == 0x6f56)||
            (ulEfidRec == 0x6f60)||(ulEfidRec == 0x6f61)||(ulEfidRec == 0x6f78)||(ulEfidRec == 0x6f7b)||(ulEfidRec == 0x6fad)||
            (ulEfidRec == 0x6fd9)||(ulEfidRec == 0x6fdb)||(ulEfidRec == 0x6fdc)||(ulEfidRec == 0x6fe8)||(ulEfidRec == 0x6fec)||
            (ulEfidRec == 0x2fe2)||(ulEfidRec == 0x2f08)||(ulEfidRec == 0x4f01)||(ulEfidRec == 0x4f05)||(ulEfidRec == 0x4f06)||
            (ulEfidRec == 0x4f07)||(ulEfidRec == 0x4f0a)||(ulEfidRec == 0x6f43)))
        {
            ulEfidRec = 0;
            *output_len = ausUSIMReadLen_ST[ucUSIMChooseNo];
            OSAdpMemCpy(output_str,pUSIMRead_tbl_ST[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
        }
        else if((0 == strcmp((const char*)input_str,"4,0x00,0xb2,0x01,0x04,"))&&
            ((ulEfidRec == 0x2f00)||(ulEfidRec == 0x4f03)||(ulEfidRec == 0x6f42)||(ulEfidRec == 0x6f3c)||(ulEfidRec == 0x6f47)))
        {
            ulEfidRec = 0;
            *output_len = ausUSIMReadLen_ST[ucUSIMChooseNo];
            OSAdpMemCpy(output_str,pUSIMRead_tbl_ST[ucUSIMChooseNo],*output_len, MEM_OPERATE_0_CHECK);
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM read error in GetUsimResultInfoDummy_ST!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy_ST");
        }
    }
    else
    {
        /////////////USIM_SELECT////////////////
        if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x0c,0x3f,0x00,"))
        {
            *output_len = sizeof(ucSel3f00);
            OSAdpMemCpy(output_str,ucSel3f00,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x04,0x2f,0x00,"))
        {
            ulEfidRec = 0x2f00;
            *output_len = sizeof(ucSel2f00);
            OSAdpMemCpy(output_str,ucSel2f00,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"20,0x00,0xa4,0x04,0x04,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff,"))
        {
            *output_len = sizeof(ucSelDF);
            OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"20,0x00,0xa4,0x04,0x04,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xf0,"))
        {
            *output_len = sizeof(ucSelect_File_Fail);
            OSAdpMemCpy(output_str,ucSelect_File_Fail,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"13,0x80,0x10,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0x7f,0x7f,0xff,0x7f,"))
        {
            *output_len = 0;
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x07,"))
        {
            ulEfidRec = 0x6f07;
            *output_len = sizeof(ucSel6f07);
            OSAdpMemCpy(output_str,ucSel6f07,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x09,"))
        {
            ulEfidRec = 0x6f09;
            *output_len = sizeof(ucSel6f09);
            OSAdpMemCpy(output_str,ucSel6f09,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x09,"))
        {
            ulEfidRec = 0x6f09;
            *output_len = sizeof(ucSelect_File_Fail);
            OSAdpMemCpy(output_str,ucSelect_File_Fail,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x31,"))
        {
            ulEfidRec = 0x6f31;
            *output_len = sizeof(ucSel6f31);
            OSAdpMemCpy(output_str,ucSel6f31,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x38,"))
        {
            ulEfidRec = 0x6f38;
            *output_len = sizeof(ucSel6f38);
            OSAdpMemCpy(output_str,ucSel6f38,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x56,"))
        {
            ulEfidRec = 0x6f56;
            *output_len = sizeof(ucSel6f56);
            OSAdpMemCpy(output_str,ucSel6f56,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x60,"))
        {
            ulEfidRec = 0x6f60;
            *output_len = sizeof(ucSel6f60_1);
            OSAdpMemCpy(output_str,ucSel6f60_1,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x60,"))
        {
            ulEfidRec = 0x6f60;
            *output_len = sizeof(ucSel6f60_2);
            OSAdpMemCpy(output_str,ucSel6f60_2,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x61,"))
        {
            ulEfidRec = 0x6f61;
            *output_len = sizeof(ucSel6f61);
            OSAdpMemCpy(output_str,ucSel6f61,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x6f,0x78,"))
        {
            ulEfidRec = 0x6f78;
            *output_len = sizeof(ucSel6f78);
            OSAdpMemCpy(output_str,ucSel6f78,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x7b,"))
        {
            ulEfidRec = 0x6f7b;
            *output_len = sizeof(ucSel6f7b);
            OSAdpMemCpy(output_str,ucSel6f7b,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xad,"))
        {
            ulEfidRec = 0x6fad;
            *output_len = sizeof(ucSel6fad);
            OSAdpMemCpy(output_str,ucSel6fad,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xd9,"))
        {
            ulEfidRec = 0x6fd9;
            *output_len = sizeof(ucSel6fd9);
            OSAdpMemCpy(output_str,ucSel6fd9,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xdb,"))
        {
            ulEfidRec = 0x6fdb;
            *output_len = sizeof(ucSel6fdb);
            OSAdpMemCpy(output_str,ucSel6fdb,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xdc,"))
        {
            ulEfidRec = 0x6fdc;
            *output_len = sizeof(ucSel6fdc);
            OSAdpMemCpy(output_str,ucSel6fdc,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xe8,"))
        {
            ulEfidRec = 0x6fe8;
            *output_len = sizeof(ucSel6fe8);
            OSAdpMemCpy(output_str,ucSel6fe8,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0xec,"))
        {
            ulEfidRec = 0x6fec;
            *output_len = sizeof(ucSel6fec);
            OSAdpMemCpy(output_str,ucSel6fec,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x0c,0x7f,0xff,0x5f,0xc0,0x4f,0x01,"))
        {
            ulEfidRec = 0x4f01;
            *output_len = sizeof(ucSel4f01);
            OSAdpMemCpy(output_str,ucSel4f01,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x03,"))
        {
            ulEfidRec = 0x4f03;
            *output_len = sizeof(ucSel4f03);
            OSAdpMemCpy(output_str,ucSel4f03,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x05,"))
        {
            ulEfidRec = 0x4f05;
            *output_len = sizeof(ucSel4f05);
            OSAdpMemCpy(output_str,ucSel4f05,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x06,"))
        {
            ulEfidRec = 0x4f06;
            *output_len = sizeof(ucSel4f06);
            OSAdpMemCpy(output_str,ucSel4f06,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x07,"))
        {
            ulEfidRec = 0x4f07;
            *output_len = sizeof(ucSel4f07);
            OSAdpMemCpy(output_str,ucSel4f07,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"10,0x00,0xa4,0x08,0x04,0x7f,0xff,0x5f,0xc0,0x4f,0x0a,"))
        {
            ulEfidRec = 0x4f0a;
            *output_len = sizeof(ucSel4f0a);
            OSAdpMemCpy(output_str,ucSel4f0a,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x0c,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSelAuth);
            OSAdpMemCpy(output_str,ucSelAuth,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x2f,0xe2,"))
        {
            ulEfidRec = 0x2fe2;
            *output_len = sizeof(ucSel2fe2);
            OSAdpMemCpy(output_str,ucSel2fe2,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x2f,0x08,"))
        {
            ulEfidRec = 0x2f08;
            *output_len = sizeof(ucSel2f08);
            OSAdpMemCpy(output_str,ucSel2f08,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x0c,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSel7fff);
            OSAdpMemCpy(output_str,ucSel7fff,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x08,0x04,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSelDF);
            OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
        }
        else if(0 == strcmp((const char*)input_str,"6,0x00,0xa4,0x00,0x04,0x7f,0xff,"))
        {
            *output_len = sizeof(ucSelDF);
            OSAdpMemCpy(output_str,ucSelDF,*output_len, MEM_OPERATE_0_CHECK);
        }
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x42,"))
		{
			ulEfidRec = 0x6f42;
			*output_len = sizeof(ucSel6f42);
			OSAdpMemCpy(output_str,ucSel6f42,*output_len, MEM_OPERATE_0_CHECK);
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x43,"))
		{
			ulEfidRec = 0x6f43;
			*output_len = sizeof(ucSel6f43);
			OSAdpMemCpy(output_str,ucSel6f43,*output_len, MEM_OPERATE_0_CHECK);
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x3c,"))
		{
			ulEfidRec = 0x6f3c;
			*output_len = sizeof(ucSel6f3c);
			OSAdpMemCpy(output_str,ucSel6f3c,*output_len, MEM_OPERATE_0_CHECK);
		}
		else if(0 == strcmp((const char*)input_str,"8,0x00,0xa4,0x08,0x04,0x7f,0xff,0x6f,0x47,"))
		{
			ulEfidRec = 0x6f47;
			*output_len = sizeof(ucSel6f47);
			OSAdpMemCpy(output_str,ucSel6f47,*output_len, MEM_OPERATE_0_CHECK);
		}
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM select error in GetUsimResultInfoDummy_ST!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "GetUsimResultInfoDummy_ST");
        }
    }
}

VOID UpdateUsimInfoDummy_ST(const char *infor_header, UINT8 *input_str, UINT8 input_len)
{
    UINT8 *pEfid = NULL;
    UINT16 usSize = 0;

    if(ulEfidRec == 0)
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
    }
    if(0 == strcmp(infor_header,"4,0x00,0xb2,0x01,0x04,2,0x90,0x00,"))
    {
        if(ulEfidRec == 0x2f00)
        {
            pEfid = ucRead2f00;
        }
		else if(ulEfidRec == 0x6f42)
		{
			pEfid = ucRead6f42;
		}
		else if(ulEfidRec == 0x6f3c)
		{
			pEfid = ucRead6f3c;
		}
		else if(ulEfidRec == 0x6f47)
		{
			pEfid = ucRead6f47;
		}
        else if(ulEfidRec == 0x4f03)
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01"))
            {
                g_UiccDetectCnt++;
            }
            pEfid = ucRead4f03;
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
        }
        ulEfidRec = 0;
        if(0 != input_len)
        {
            OSAdpMemCpy(pEfid +4,input_str,input_len, MEM_OPERATE_0_CHECK);
        }
    }
    else if(0 == strcmp(infor_header,"4,0x00,0xb0,0x00,0x00,2,0x90,0x00,"))
    {
        if(ulEfidRec == 0x6f09)
        {
            if (0 == strcmp((const char*)ScriptName,"USIM_PT_08_01_01"))
            {
                g_UiccDetectCnt++;
            }
            pEfid = ucRead6f09;
            usSize = sizeof(ucRead6f09);
        }
        else if(ulEfidRec == 0x6f60)
        {
            pEfid = ucRead6f60;
            usSize = sizeof(ucRead6f60);
        }
        else if(ulEfidRec == 0x6f7b)
        {
            pEfid = ucRead6f7b;
            usSize = sizeof(ucRead6f7b);
        }
        else if(ulEfidRec == 0x6f07)
        {
            pEfid = ucRead6f07;
            usSize = sizeof(ucRead6f07);
        }
        else if(ulEfidRec == 0x4f01)
        {
            pEfid = ucRead4f01;
            usSize = sizeof(ucRead4f01);
        }
        else if(ulEfidRec == 0x4f05)
        {
            pEfid = ucRead4f05;
            usSize = sizeof(ucRead4f05);
        }
        else
        {
            OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, EFID error!");
            PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
        }
        ulEfidRec = 0;
        OSAdpMemSet(pEfid + 4,0,(usSize - 4), MEM_OPERATE_0_CHECK);
        if(0 != input_len)
        {
            OSAdpMemCpy(pEfid + 4,input_str,input_len, MEM_OPERATE_0_CHECK);
        }
    }
    else
    {
        OutputTraceMessage(USIM_LOG_LEVEL_FATAL,"USIM update error in UpdateUsimInfoDummy, input string error!");
        PS_ASSERT(ucAssertFlg, PS_ERR_FATAL_PS, USIM_THREAD_ID, "UpdateUsimInfoDummy");
    }
}

UINT16 Dumy_usim_exchange_apdu_ST(T_DRV_SCI_cmd_header cmd_header,
    T_DRV_SCI_data_info data_info, 
    T_DRV_SCI_result_info *result_info)
{
    UINT8 *pucInputTemp;
    UINT8 *pucInputStr;
    UINT8 *pucOutputStr;
    UINT32 output_len = 0;
    UINT16 result;
    UINT8 index = 0;
    UINT8 i = 0;
    UINT8 ucRand[17];
    UINT8 ucAutnLen = 0;
    UINT8 ucAutn[16];
    UINT8 ucMatchFlg = 0;
    UINT8 ucReadStatus[18] = {0x84,0x10,0xa0,0x00,0x00,0x00,0x87,0x10,0x02,0xff,0x86,0xf0,0x00,0x89,0xff,0xff,0xff,0xff};
    UINT8 ucAuts[14] = {0x14,0x58,0x33,0x5c,0xc3,0x39,0x23,0xc5,0xc0,0x14,0x58,0x33,0xa3,0x3c};
    UINT8 ucPinTemp[8];
    UINT8 aucSuci_ProfileA[53] = {0x01,0x00,0xf1,0x10,0x10,0x20,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
        0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x81,0x18,0x32,
        0x18,0x2f,0x01,0x01,0x01,0x01,0x01};
    UINT8 aucSuci_ProfileB[55] = {0x01,0x00,0xf1,0x10,0x10,0x20,0x02,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,
        0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x81,
        0x18,0x32,0x18,0x2f,0x01,0x01,0x01,0x01,0x01};
    if (cmd_header.ins == DRV_SCI_INS_UPDATE_RECORD)
    {
        ucSelectFlg = 0;
        UpdateUsimInfoDummy_ST("4,0x00,0xb2,0x01,0x04,2,0x90,0x00,", data_info.data, data_info.c_data);
        return 0x9000;
    }
    if ((cmd_header.ins == DRV_SCI_INS_UPDATE_BINARY)&&(ucSelectFlg == 1))
    {
        ucSelectFlg = 0;
        UpdateUsimInfoDummy_ST("4,0x00,0xb0,0x00,0x00,2,0x90,0x00,", data_info.data, data_info.c_data);
        return 0x9000;
    }

    if (cmd_header.ins == DRV_SCI_INS_STATUS)
    {
        ucSelectFlg = 0;
        g_UiccDetectCnt++;

        result_info->c_result = 18;
        OSAdpMemCpy(result_info->result, ucReadStatus, 18, MEM_OPERATE_0_CHECK);

        return 0x9000;
    }
    if (cmd_header.ins == DRV_SCI_INS_AUTHENTICATE)
    {
        ucSelectFlg = 0;
        OSAdpMemCpy(ucRand, &data_info.data[1], 16, MEM_OPERATE_0_CHECK);
        ucAutnLen = data_info.data[17];
        if (ucAutnLen != 0)
        {
            OSAdpMemCpy(ucAutn, &data_info.data[18], ucAutnLen, MEM_OPERATE_0_CHECK);
        }
        ucMatchFlg = Usim_Authentication_Ret(ucRand, ucAutn);
        if (0xFF == ucAutn[0])
        {
            OSAdpMemCpy(aucAuts, ucAuts, 14, MEM_OPERATE_0_CHECK);
            ucMatchFlg = 1;
        }
        switch(ucMatchFlg)
        {
        case 0:
            result_info->c_result = 52;
            result_info->result[0] = 0xDB;
            result_info->result[1] = 16;
            OSAdpMemCpy(&result_info->result[2],aucRes,16, MEM_OPERATE_0_CHECK);
            result_info->result[18] = 16;
            OSAdpMemCpy(&result_info->result[19],aucCk,16, MEM_OPERATE_0_CHECK);
            result_info->result[35] = 16;
            OSAdpMemCpy(&result_info->result[36],aucIk,16, MEM_OPERATE_0_CHECK);

            return 0x9000;
        case 1:
            result_info->c_result = 16;
            result_info->result[0] = 0xDC;
            result_info->result[1] = 14;
            OSAdpMemCpy(&result_info->result[2],aucAuts,14, MEM_OPERATE_0_CHECK);
            return 0x9000;
        case 2:
            return 0x9862;
            /* YYN: non-EPS authentication unacceptable handling   start */
        case 3:
            return 0xFFFF;
            /* YYN: non-EPS authentication unacceptable handling   end */
        default:
            return 0x0000;
        }
    }
    if (DRV_SCI_INS_UICC_SUSPEND == cmd_header.ins)
    {
        ucSelectFlg = 0;
        if(0 == cmd_header.p1)
        {//suspend
            result_info->c_result = 10;
            result_info->result[0] = 1;
            result_info->result[1] = 2;
            for (i = 0; i < 8; i++)
            {
                result_info->result[2+i] = i;
            }
            return 0x9000;
        }
        else if (1 == cmd_header.p1)
        {//resume
            return 0x9000;
        }
    }
    if (DRV_SCI_INS_MANAGE_CHANNEL == cmd_header.ins)
    {
        if(0 == cmd_header.p1)
        {
            result_info->c_result = 1;
            result_info->result[0] = 1;
            return 0x9000;
        }
        else
        {
            return 0x9000;
        }
    }
    //add for PIN test start
    if ((DRV_SCI_INS_VERIFY_CHV == cmd_header.ins)
        || (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
        || (DRV_SCI_INS_CHANGE_CHV == cmd_header.ins)
        || (DRV_SCI_INS_DISABLE_CHV == cmd_header.ins)
        || (DRV_SCI_INS_ENABLE_CHV == cmd_header.ins))
    {
        if (0 == data_info.c_data)
        {
            if (DRV_SCI_INS_VERIFY_CHV == cmd_header.ins)
            {
                if (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_04"))
                {
                    return 0x6982;
                }
                else if (0x01 == cmd_header.p2)
                {
                    result = 0x63C0 + ucPinReAttemptNum;
                    return result;
                }
                else
                {
                    return 0x63C3;
                }
            }
            else
            {
                if (((0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_02")) && (0x81 == cmd_header.p2))
                    || (0 == strcmp((const char*)ScriptName,"USIM_PT_01_02_03"))
                    )
                {
                    return 0x6982;
                }
                else if (0x01 == cmd_header.p2)
                {
                    result = 0x63C0 + ucPucReAttemptNum;
                    return result;
                }
                else
                {
                    return 0x63CA;
                }
            }
        }
        else
        {
            if (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
            {
                OSAdpMemCpy(ucPinTemp, ucUsimPuk, 8, MEM_OPERATE_0_CHECK);
            }
            else
            {
                OSAdpMemCpy(ucPinTemp, ucUsimPin, 8, MEM_OPERATE_0_CHECK);
            }
            for(i = 0; i < 8;i++)
            {
                if (ucPinTemp[i] != data_info.data[i])
                {
                    break;
                }
            }
            if (8 == i)
            {
                if ((DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
                    || (DRV_SCI_INS_CHANGE_CHV == cmd_header.ins))
                {
                    OSAdpMemCpy(ucUsimPin, &data_info.data[8], 8, MEM_OPERATE_0_CHECK);
                }
                else if (DRV_SCI_INS_DISABLE_CHV == cmd_header.ins)
                {
                    ucSelDF[54] &= 0x7F;
                }
                else if (DRV_SCI_INS_ENABLE_CHV == cmd_header.ins)
                {
                    ucSelDF[54] |= 0x80;
                }
                ucPinReAttemptNum = 3;
                ucPucReAttemptNum = 10;
                return 0x9000;
            }
            else
            {
                if (DRV_SCI_INS_UNBLOCK_CHV == cmd_header.ins)
                {
                    if (0 == strcmp((const char*)ScriptName,"USIM_PT_06_05_02"))
                    {
                        ucPucReAttemptNum = 0;
                    }
                    if (0 != ucPucReAttemptNum)
                    {
                        ucPucReAttemptNum --;
                        result = 0x63C0 + ucPucReAttemptNum;
                        return result;
                    }
                    else
                    {
                        return 0x6983;
                    }
                }
                else
                {
                    if (0 != ucPinReAttemptNum)
                    {
                        ucPinReAttemptNum --;
                        result = 0x63C0 + ucPinReAttemptNum;
                        return result;
                    }
                    else
                    {
                        return 0x6983;
                    }
                }
            }
        }
    }

    if (DRV_SCI_INS_GET_IDENTITY == cmd_header.ins)
    {
        result_info->c_result = 55;
        result_info->result[0] = 0xA1;
        result_info->result[1] = 53;
        OSAdpMemCpy(&result_info->result[2], aucSuci_ProfileA, 53, MEM_OPERATE_0_CHECK);
        return 0x9000;
    }
    //add for PIN test end
    pucInputStr = (UINT8*)PsMalloc(200, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucInputStr, 0, 200, MEM_OPERATE_0_CHECK);
    *(pucInputStr + index) = (((data_info.c_data + 4)/10) * 16) >> 4;
    if (*(pucInputStr + index) > 0)
    {
        *(pucInputStr + index++) += 48;
    }

    *(pucInputStr + index++) = ((data_info.c_data + 4)%10) + 48;
    pucInputTemp = (UINT8*)PsMalloc(100, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucInputTemp, 0, 100, MEM_OPERATE_0_CHECK);
    *(pucInputTemp) = cmd_header.cla;
    *(pucInputTemp + 1) = cmd_header.ins;
    *(pucInputTemp + 2) = cmd_header.p1;
    *(pucInputTemp + 3) = cmd_header.p2;
    if (0 != data_info.c_data)
    {
        OSAdpMemCpy((pucInputTemp + 4), data_info.data, data_info.c_data, MEM_OPERATE_0_CHECK);
    }


    for (i=0; i < data_info.c_data + 4; i++)
    {
        *(pucInputStr + index++) = ',';
        *(pucInputStr + index++) = '0';
        *(pucInputStr + index++) = 'x';
        *(pucInputStr + index) = *(pucInputTemp + i) >> 4;
        if (*(pucInputStr + index) > 9)
        {
            *(pucInputStr + index++) += 87;
        }
        else
        {
            *(pucInputStr + index++) += 48;
        }
        *(pucInputStr + index) = *(pucInputTemp + i)&0x0F;
        if (*(pucInputStr + index) > 9)
        {
            *(pucInputStr + index++) += 87;
        }
        else
        {
            *(pucInputStr + index++) += 48;
        }
    }
    PsFree(pucInputTemp);
    *(pucInputStr + index++) = ',';
    *(pucInputStr + index++) = '\0';

    pucOutputStr = (UINT8*)PsMalloc(500, OSADP_MEM_NO_WAIT);
    OSAdpMemSet(pucOutputStr, 0, 500, MEM_OPERATE_0_CHECK);
    if (cmd_header.ins == DRV_SCI_INS_SELECT)
    {
        ucSelectFlg = 1;
    }
    else
    {
        ucSelectFlg = 0;
    }
    GetUsimResultInfoDummy_ST(pucInputStr, pucOutputStr, &output_len);
    result_info->c_result = *(pucOutputStr + 3);
    result = *(pucOutputStr + 1);
    result = result << 8;
    result += *(pucOutputStr + 2);

    if (0 != *(pucOutputStr + 3))
    {
        OSAdpMemCpy(result_info->result, (pucOutputStr + 4), *(pucOutputStr + 3), MEM_OPERATE_0_CHECK);
    }

    PsFree(pucInputStr);
    PsFree(pucOutputStr);

    if (result == 0)
    {
        result = 0x9404;
    }

    return result;
}

/*******************************************************************************
MODULE    : API_ATC_USIM_Remove
FUNCTION  : Remove Card when external inform
NOTE      :
HISTORY   :
1.  wuhao    2019-7-02  Create
*******************************************************************************/
VOID API_ATC_USIM_Remove()
{
    Usim_DriveCardRemove();
    return;
}
#endif
